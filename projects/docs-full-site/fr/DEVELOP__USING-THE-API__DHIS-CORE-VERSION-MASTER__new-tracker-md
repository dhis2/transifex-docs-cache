---
edit_url: "https://github.com/dhis2/dhis2-docs/blob/master/src/developer/web-api/new-tracker.md"
revision_date: "2023-04-04"
tags:
    - Version Master de DHIS2 Central
    - Développer
---

# New Tracker { #new-tracker }

Version 2.36 of DHIS2 introduced a set of new tracker endpoints dedicated to importing and querying tracker objects (Including tracked entities, enrollments, events, and relationships). These new endpoints set a discontinuity with earlier implementations. Re-engineering the endpoints allowed developers to improve, redesign, and formalize the API's behavior to improve the Tracker services.

The newly introduced endpoints consist of:

-   `POST /api/tracker`
-   `GET /api/tracker/enrollments`
-   `GET /api/tracker/events`
-   `GET /api/tracker/trackedEntities`
-   `GET /api/tracker/relationships`

> **NOTE**
>
> -   The old endpoints are marked as deprecated but still work as before.
> -   Some functionality is not yet ready in the new endpoints, but they support their primary use-cases.

## Changes in the API { #changes-in-the-api }

Property names used in the API have changed to use consistent naming across all the new endpoints.

### Tracker Import changelog (`POST`) { #tracker-import-changelog-post }

The following table highlights the differences between the previous tracker import endpoints (/api/trackedEntityInstance, /api/enrollments, /api/events and /api/relatiosnhips) and the new endpoint (/api/tracker). All endpoints are still currently available.

| Tracker Object | Previously | Now |
| --- | --- | --- |
| **Attribute** | `created`<br>`lastUpdated` | `createdAt`<br>`updatedAt` |
| **DataValue** | `created`<br>`lastUpdated`<br>`createByUserInfo`<br>`lastUpdatedByUserInfo` | `createdAt`<br>`updatedAt`<br>`createdBy`<br>`updatedBy` |
| **Enrollment** | `created`<br>`createdAtClient`<br>`lastUpdated`<br>`lastUpdatedAtClient`<br>`trackedEntityInstance`<br>`enrollmentDate`<br>`incidentDate`<br>`completedDate`<br>`createByUserInfo`<br>`lastUpdatedByUserInfo` | `createdAt`<br>`createdAtClient`<br>`updatedAt`<br>`updatedAtClient`<br>`trackedEntity`<br>`enrolledAt`<br>`occurredAt`<br>`completedAt`<br>`createdBy`<br>`updatedBy` |
| **Manifestation** | `trackedEntityInstance`<br>`eventDate`<br>`dueDate`<br>`created`<br>`createdAtClient`<br>`lastUpdated`<br>`lastUpdatedAtClient`<br>`completedDate`<br>`createByUserInfo`<br>`lastUpdatedByUserInfo`<br>`assignedUser`\* | `trackedEntity`<br>`occurredAt`<br>`scheduledAt`<br>`createdAt`<br>`createdAtClient`<br>`updatedAt`<br>`updatedAtClient`<br>`completedAt`<br>`createdBy`<br>`updatedBy`<br>`assignedUser`\* |
| **Remarque** | `storedDate`<br>`lastUpdatedBy` | `storedAt`<br>`createdBy` |
| **ProgramOwner** | `ownerOrgUnit`<br>`trackedEntityInstance` | `orgUnit`<br>`trackedEntity` |
| **RelationshipItem** | `trackedEntityInstance.trackedEntityInstance`<br>`enrollment.enrollment`<br>`event.event` | `trackedEntity`<br>`enrollment`<br>`event` |
| **Relationship** | `created`<br>`lastUpdated` | `createdAt`<br>`updatedAt` |
| **TrackedEntity** | `trackedEntityInstance`<br>`created`<br>`createdAtClient`<br>`lastUpdated`<br>`lastUpdatedAtClient`<br>`createByUserInfo`<br>`lastUpdatedByUserInfo` | `trackedEntity`<br>`createdAt`<br>`createdAtClient`<br>`updatedAt`<br>`updatedAtClient`<br>`createdBy`<br>`updatedBy` |

> **Note**
>
> Field `assignedUser` was a String before, now it is of type User:
>
> ```json
> {
>     "assignedUser": {
>         "uid": "ABCDEF12345",
>         "username": "username",
>         "firstName": "John",
>         "surname": "Doe"
>     }
> }
> ```

### Tracker Export changelog (`GET`) { #tracker-export-changelog-get }

The `GET` endpoints all conform to the same naming conventions reported in the previous paragraph. Additionally, we made some changes regarding the request parameters to respect the same naming conventions here as well.

These tables highlight the old endpoint differences in request parameters for `GET` endpoints compared to the new

#### Request parameter changes for `GET /api/tracker/enrollments` { #request-parameter-changes-for-get-apitrackerenrollments }

| Previously                             | Now                                 |
| -------------------------------------- | ----------------------------------- |
| `ou`                                   | `orgUnit` (unité d'organisation)                           |
| `lastUpdated`<br>`lastUpdateDuration`  | `updatedAfter`<br>`updatedWithin`   |
| `programStartDate`<br>`programEndDate` | `enrolledAfter`<br>`enrolledBefore` |
| `trackedEntityInstance`                | `trackedEntity` (entité suivie)                     |

#### Request parameter changes for `GET /api/tracker/events` { #request-parameter-changes-for-get-apitrackerevents }

| Previously | Now |
| --- | --- |
| `trackedEntityInstance` | `trackedEntity` (entité suivie) |
| `startDate`<br>`endDate` | `occurredAfter`<br>`occurredBefore` |
| `dueDateStart`<br>`dueDateEnd` | `scheduledAfter`<br>`scheduledBefore` |
| `lastUpdated` | Removed - obsolete, see: <br><ul><li>`updatedAfter`</li><li>`updatedBefore`</li></ul> |
| `lastUpdatedStartDate`<br>`lastUpdateEndDate`<br>`lastUpdateDuration` | `updatedAfter`<br>`updatedBefore`<br>`updatedWithin` |

#### Request parameter changes for `GET /api/tracker/trackedEntities` { #request-parameter-changes-for-get-apitrackertrackedentities }

| Previously | Now |
| --- | --- |
| `trackedEntityInstance` | `trackedEntity` (entité suivie) |
| `ou` | `orgUnit` (unité d'organisation) |
| `programStartDate`<br>`programEndDate` | Removed - obsolete, see <br><ul><li>`enrollmentEnrolledAfter`</li><li>`enrollmentEnrolledBefore`</li></ul> |
| `programEnrollmentStartDate`<br>`programEnrollmentEndDate` | `enrollmentEnrolledAfter`<br>`enrollmentEnrolledBefore` |
| `programIncidentStartDate`<br>`programIncidentEndDate` | `enrollmentOccurredAfter`<br>`enrollmentOccurredBefore` |
| `eventStartDate`<br>`eventEndDate` | `eventOccurredAfter`<br>`eventOccurredBefore` |
| `lastUpdatedStartDate`<br>`lastUpdateEndDate`<br>`lastUpdateDuration` | `updatedAfter`<br>`updatedBefore`<br>`updatedWithin` |

## Objets Tracker { #webapi_nti_tracker_objects }

Tracker est constitué de différents types d'objets interconnectés destinés à représenter les données. Dans cette section, nous montrerons et décrirons chacun des objets utilisés dans l'API du Tracker.

### Tracked Entity { #tracked-entity }

Les `entités suivies` constituent la base du modèle Tracker.

| Propriété | Description | Obligatoire | Immuable | Type | Exemple |
| --- | --- | --- | --- | --- | --- |
| Entité suivie | L’identifiant de l’entité suivie. Il est généré au cas où il n'est pas fourni | Non | Oui | Chaîne : Uid | ABCDEF12345 |
| TrackedEntityType (Type d'entité suivie) | Le type d’entité suivie. | Oui | Oui | Chaîne : Uid | ABCDEF12345 |
| créé à | Date à laquelle l'utilisateur a créé l'entité suivie. Elle est définie sur le serveur. | Non | Non | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| crééAtClient (Création au niveau du client) | Date à laquelle l'utilisateur a créé l'entité suivie au niveau du client. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAt (mis à jour à) | Date de la dernière mise à jour de l'objet. Elle est définie sur le serveur. | Non | Non | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAtClient (mise à jour au niveau du client) | Date de la dernière mise à jour de l'objet au niveau du client. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| orgUnit (Unité d'organisation) | L'unité d'organisation dans laquelle l'utilisateur a créé l'entité suivie. | Oui | Oui | Chaîne : Uid | ABCDEF12345 |
| inactif | Indique si l'entité suivie est inactive ou non. | Non | Oui | Booléen | Par défaut : Faux, Vrai |
| supprimé | Indique si l'entité suivie a été supprimée. Ne peut être modifié qu'au moment de la suppression. | Non | Non | Booléen | Faux jusqu'à suppression |
| géométrie | A geographical representation of the tracked entity. Based on the "featureType" of the TrackedEntityType. | Non | Oui | GeoJson | {<br>"type": "POINT",<br>"coordonnées": [123.0, 123.0]<br>} |
| Stocké par | Référence client indiquant celui a stocké/créé l’entité suivie. | Non | Oui | Chaîne : Toute | John Doe |
| createdBy (créé par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a créé l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |
| updatedBy (mis à jour par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a mis à jour l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |
| les attributs | Une liste de valeurs d'attributs d'entité suivie appartenant à l'entité suivie. | Non | Oui | Liste des valeurs d'attributs d'entités suivies | Voir l'attribut |
| inscriptions | Une liste des inscriptions appartenant à l’entité suivie. | Non | Oui | Liste des inscriptions | Voir les inscriptions |
| relations | Une liste de relations connectées à l'entité suivie. | Non | Oui | Liste des relations | Voir les relations |
| Propriétaires du programme | Liste des unités d'organisation qui ont accès via des programmes spécifiques à cette entité suivie. Voir « Propriété du programme » pour en savoir plus. | Non | Oui | Liste des propriétaires du programme | Voir la section « Propriété du programme » |

> **Remarque**
>
> Les `entités suivies` "possèdent" toutes les `Valeurs d'attribut d'entités suivies` (ou les "attributs" décrits dans le tableau précédent). Cependant, les `attributs d'entités suivies` sont soit connectés à une `entité suivie` via son `type d'entité suivie` soit à un `programme`. Nous désignons souvent cette séparation par `Attributs de type d'entité suivi` et `Attributs de programme d'entité suivi`. L'importance de cette distinction est liée au contrôle d'accès et à la limitation des informations que l'utilisateur peut voir.
>
> Les "attributs" mentionnés dans `Entité suivie` sont des `Attributs de type d'entité suivie`.

### Inscription { #enrollment }

Les `Entités suivies` peuvent s'inscrire aux `Programmes` pour lesquels elles sont éligibles. Les entités suivies sont éligibles tant que le programme est configuré avec le même `Type d'entité suivie` que l'entité suivie. Nous représentons l'inscription avec l'objet `Inscription`, que nous décrivons dans cette section.

| Propriété | Description | Obligatoire | Immuable | Type | Exemple |
| --- | --- | --- | --- | --- | --- |
| inscription | L’identifiant de l'inscription. Il est généré au cas où il n'est pas fourni | Non | Oui | Chaîne : Uid | ABCDEF12345 |
| de paludisme) ». | Le programme que représente l’inscription. | Oui | Non | Chaîne : Uid | ABCDEF12345 |
| Entité suivie | Une référence à l’entité suivie inscrite. | Oui | Oui | Chaîne : Uid | ABCDEF12345 |
| TrackedEntityType (Type d'entité suivie) | Uniquement pour lire les données. Il s'agit du type de l'entité suivie inscrite | Non | Oui | Chaîne : Uid | ABCDEF12345 |
| statut | Statut de l'inscription. Il est ACTIF au cas où n'est pas fourni. | Non | Non | Énumération | ACTIF, TERMINÉ, ANNULÉ |
| orgUnit (Unité d'organisation) | L'unité d'organisation dans laquelle l'utilisateur a inscrit l'entité suivie. | Oui | Non | Chaîne : Uid | ABCDEF12345 |
| orgUnitName (nom de l'unité d'organisation) | Uniquement pour lire les données. Il s'agit du nom de l'unité d'organisation où l'inscription a eu lieu. | Non | Non | Chaîne : Toute | Sierra Leone |
| créé à | Date à laquelle l'utilisateur a créé l'objet. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| crééAtClient (Création au niveau du client) | Date à laquelle l'utilisateur a créé l'objet au nibveau du client | Non | Non | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAt (mis à jour à) | Date de la dernière mise à jour de l'objet. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAtClient (mise à jour au niveau du client) | Date de la dernière mise à jour de l'objet au niveau du client. | Non | Non | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| enrolledAt (inscrit à) | Date à laquelle l'utilisateur a inscrit l'entité suivie. | Oui | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| occurredAt (s'est produit à) | Date à laquelle l'inscription a eu lieu. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| completedAt (terminé à) | Date à laquelle l'utilisateur a terminé l'inscription. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| completedBy (terminé par) | Fait référence à la personne qui a effectué l'inscription | Non | Non | Chaîne : Toute | John Doe |
| suivi | Indicates whether the enrollment requires follow-up. False if not supplied | Non | Non | Booléen | Par défaut : Faux, Vrai |
| supprimé | Indique si l'inscription a été supprimée. Ne peut être modifié qu'au moment de la suppression. | Non | Oui | Booléen | Faux jusqu'à suppression |
| géométrie | A geographical representation of the enrollment. Based on the "featureType" of the Program | Non | Non | GeoJson | {<br>"type": "POINT",<br>"coordonnées": [123.0, 123.0]<br>} |
| Stocké par | Référence client indiquant celui a stocké/créé l'inscription. | Non | Non | Chaîne : Toute | John Doe |
| createdBy (créé par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a créé l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |
| updatedBy (mis à jour par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a mis à jour l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |
| les attributs | Une liste de valeurs d'attributs d'entité suivie associées à l'inscription. | Non | Non | Liste des valeurs d'attributs d'entités suivies | Voir l'attribut |
| événements | Une liste des événements appartenant à l'inscription. | Non | Non | Liste des événements | Voir les évènements |
| relations | Une liste des relations liées à l'inscription. | Non | Non | Liste des relations | Voir les relations |
| notes | Notes liées à l'inscription. Elles ne peuvent qu'être créées. | Non | Oui | Liste des notes | Voir les notes |

> **Remarque**
>
> Les `entités suivies` "possèdent" toutes les `Valeurs d'attribut d'entités suivies` (ou les "attributs" décrits dans le tableau précédent). Cependant, les `attributs d'entités suivies` sont soit connectés à une `entité suivie` via son `type d'entité suivie` soit à un `programme`. Nous désignons souvent cette séparation par `Attributs de type d'entité suivi` et `Attributs de programme d'entité suivi`. L'importance de cette distinction est liée au contrôle d'accès et à la limitation des informations que l'utilisateur peut voir.
>
> Les "attributs" mentionnés dans `Inscription` sont des `Attributs de programmes d'entités suivies`.

### Événements { #events }

Les `Événements` font partie d'un `PROGRAMME D'ÉVÉNEMENT` ou d'un `PROGRAMME TRACKER`. Pour le `PROGRAMME TRACKER`, les événements appartiennent à une `Inscription`, laquelle appartient à une `Entité suivie`. D'un autre côté, `PROGRAMME D'ÉVÉNEMENT` concerne les `Événements` non rattachées à une `Inscription` ou à une `Entité suivie` spécifique. La différence réside dans le fait que nous effectuons ou non un suivi pour une `Entité suivie` spécifique. Nous désignons parfois les événements `PROGRAMME D'ÉVÉNEMENT` "événements anonymes "ou "événements uniques" puisqu'ils ne se représentent qu'eux-mêmes et non une autre `Entité suivie`.

Dans l'API, la différence majeure est que tous les événements sont soit rattachés à la même inscription (`PROGRAMME D'ÉVÈNEMENT`), soit à des inscriptions différentes (`PROGRAMME TRACKER`). Le tableau ci-dessous signalera les cas exceptionnels entre ces deux.

| Propriété | Description | Obligatoire | Immuable | Type | Exemple |
| --- | --- | --- | --- | --- | --- |
| événement | L'identifiant de l'événement. Il est généré au cas où il n'est pas fourni | Non | Oui | Chaîne : Uid | ABCDEF12345 |
| Étape du programme | L'étape du programme que représente l'événement. | Oui | Non | Chaîne : Uid | ABCDEF12345 |
| inscription | A reference to the enrollment which owns the event. **_Not applicable for `EVENT PROGRAM`_** | Oui | Oui | Chaîne : Uid | ABCDEF12345 |
| de paludisme) ». | Uniquement pour lire les données. Il s'agit du type de programme de l'inscription qui possède l'événement. | Non | Oui | Chaîne : Uid | ABCDEF12345 |
| Entité suivie | Only for reading data. The tracked entity which owns the event. **_Not applicable for `EVENT PROGRAM`_** | Non | Non | Chaîne : Uid | ABCDEF12345 |
| statut | Statut de l'évènement. Il est ACTIF au cas où n'est pas fourni. | Non | Non | Énumération | ACTIF, EFFECTUÉ, VISITÉ, HORAIRE, EN RETARD, SAUTÉ |
| Statut de l'inscription | Only for reading data. The status of the enrollment which owns the event. **_Not applicable for `EVENT PROGRAM`_** | Non | Non | Énumération | ACTIF, TERMINÉ, ANNULÉ |
| orgUnit (Unité d'organisation) | Il s'agit de l'unité d'organisation dans laquelle l'utilisateur a enregistré l'événement. | Oui | Non | Chaîne : Uid | ABCDEF12345 |
| orgUnitName (nom de l'unité d'organisation) | Uniquement pour lire les données. Il s'agit du nom de l'unité d'organisation où l'utilisateur a enregistré l'évènement. | Non | Non | Chaîne : Toute | Sierra Leone |
| créé à | Date à laquelle l'utilisateur a créé l'évènement. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| crééAtClient (Création au niveau du client) | Date à laquelle l'utilisateur a créé l'évènement au niveau du client | Non | Non | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAt (mis à jour à) | Date de la dernière mise à jour de l'évènement. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAtClient (mise à jour au niveau du client) | Date de la dernière mise à jour de l'évènement au niveau du client. | Non | Non | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| scheduledAt (programmé à) | Date à laquelle l'évènement a été programmée. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| occurredAt (s'est produit à) | Date à laquelle quelque chose se passe. | Oui | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| completedAt (terminé à) | Date à laquelle l'utilisateur a effectué l'évènement. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| completedBy (terminé par) | Fait référence à la personne qui a effectué l'évènement | Non | Non | Chaîne : Toute | John Doe |
| suivi | Indique si l'événement a été marqué pour un suivi. Faux si non fourni | Non | Non | Booléen | Par défaut : Faux, Vrai |
| supprimé | Indique si l'évènement a été supprimée. Ne peut être modifié qu'au moment de la suppression. | Non | Oui | Booléen | Faux jusqu'à suppression |
| géométrie | A geographical representation of the event. Based on the "featureType" of the Program Stage | Non | Non | GeoJson | {<br>"type": "POINT",<br>"coordonnées": [123.0, 123.0]<br>} |
| Stocké par | Référence client indiquant celui a stocké/créé l'évènement. | Non | Non | Chaîne : Toute | John Doe |
| createdBy (créé par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a créé l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |
| updatedBy (mis à jour par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a mis à jour l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |
| attributeOptionCombo (combinaison d'options d'attribut) | Combinaison d'options d'attribut pour l'événement. Utiliser l'option par défaut s’il n’est pas fourni ou configuré. | Non | Non | Chaîne : Uid | ABCDEF12345 |
| attributeCategoryOptions (options de catégorie d'attribut) | Il s'agit de l'option de catégorie d'attribut pour l'événement. Utiliser l'option par défaut si rien n’est fourni ou configuré. | Non | Non | Chaîne : Uid | ABCDEF12345 |
| assignedUser (Utilisateur assigné) | Fait référence à un utilisateur qui a été assigné à l'événement. | Non | Non | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |
| dataValues (Valeurs de données) | Liste des valeurs de données liées à l'événement. | Non | Non | Liste des valeurs d'attributs d'entités suivies | Voir l'attribut |
| relations | Liste des relations liées à l'évènement. | Non | Non | Liste des relations | Voir les relations |
| notes | Notes liées à l'évènement. Elles ne peuvent qu'être créées. | Non | Oui | Liste des notes | Voir les notes |

### Relationship { #relationship }

Les `Relations` sont des objets qui relient deux autres objets Tracker. Les contraintes auxquelles chaque côté de la relation doit se conformer sont basées sur le `Type de relation` de la `Relation`.

| Propriété | Description | Obligatoire | Immuable | Type | Exemple |
| --- | --- | --- | --- | --- | --- |
| relation | L'identifiant de la relation. Il est généré au cas où il n'est pas fourni | Non | Oui | Chaîne : Uid | ABCDEF12345 |
| type de relation | Il s'agit du type de relation. Il détermine quels objets peuvent être reliés dans une relation. | Oui | Oui | Chaîne : Uid | ABCDEF12345 |
| Nom de la relation | Uniquement pour lire les données. Il s'agit du nom du type de relation de cette relation | Non | Non | Chaîne : Toute | Sibling |
| créé à | Date à laquelle l'utilisateur a créé la relation. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAt (mis à jour à) | Date de la dernière mise à jour de la relation. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| bidirectionnel | Uniquement pour lire les données. Indique si le type de relation est bidirectionnel ou non. | Non | Non | Booléen | Vrai ou faux |
| de, à | Fait référence à chaque côté de la relation. Doit être conforme aux contraintes définies dans le type de relation | Oui | Oui | Élément de la relation | {"trackedEntity": {"trackedEntity": "ABCEF12345"}}, {"enrollment": {"enrollment": "ABCDEF12345"}} or {"event": {"event": "ABCDEF12345" }} |

> **Note**
>
> `Relationship item` represents a link to an object. Since a `relationship` can be between any tracker object like `tracked entity`, `enrollment`, and `event`, the value depends on the `relationship type`. For example, if the `relationship type` connects from an `event` to a `tracked entity`, the format is strict:
>
> ```json
> {
>     "from": {
>         "event": { "event": "ABCDEF12345" }
>     },
>     "to": {
>         "trackedEntity": { "trackedEntity": "FEDCBA12345" }
>     }
> }
> ```

### Attribut { #attribute }

Les `Attributs` sont les valeurs qui décrivent les `entités suivies`. Ils peuvent être reliés via un `type d'entité suivi` ou un `programme`. Implicitement, cela signifie que les `attributs` peuvent faire partie à la fois d'une `entité suivie` et d'une `inscription`.

| Propriété | Description | Obligatoire | Immuable | Type | Exemple |
| --- | --- | --- | --- | --- | --- |
| attribut | Fait référence à l’attribut d’entité suivi représenté. | Oui | Oui | Chaîne : Uid | ABCDEF12345 |
| code | Uniquement pour lire les données. Il s'agit du code de l'attribut de l'entité suivie | Non | Non | Chaîne : Toute | ABC |
| Nom d'affichage | Uniquement pour lire les données. Il s'agit du nom d'affichage de l'attribut de l'entité suivie | Non | Non | Chaîne : Toute | Nom |
| créé à | Date à laquelle la valeur a été ajoutée. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAt (mis à jour à) | Date de la dernière mise à jour de la valeur. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| Stocké par | Référence client indiquant celui a stocké/créé la valeur. | Non | Non | Chaîne : Toute | John Doe |
| Type de valeur | Uniquement pour lire les données. Il s'agit du type de valeur que l'attribut représente. | Non | Non | Énumération | TEXTE, ENTIER et plus |
| valeur | La valeur de l'attribut d'entité suivi. | Non | Non | Chaîne : Toute | John Doe |

> **Remarque**
>
> Pour les `attributs`, seules les propriétés "attribut" et "valeur" sont requises lors de l'ajout des données. Une "valeur" peut être nulle, ce qui suppose que l'utilisateur doit la supprimer.
>
> Dans le contexte des objets Tracker, nous considérons les `Attributs d'entité suivie` et les `Valeurs d'attribut d'entité suivie` comme des "attributs". Cependant, les attributs sont également des éléments distincts, liés aux métadonnées. Il est donc essentiel de séparer les attributs Tracker et les attributs de métadonnées. Dans l'API du Tracker, il est possible de référencer les attributs des métadonnées lors de la spécification du `Schéma d'identification` (voir les paramètres de requête pour plus d'informations).

### Data Values { #data-values }

Alors que les `Attributs` décrivent une `entité suivie` ou une `inscription`, les `valeurs de données` décrivent un `évènement`. La différence majeure est que les `attributs ` ne peuvent avoir qu'une seule valeur pour une `entité suivie` donnée. En revanche, les `valeurs de données` peuvent avoir plusieurs valeurs différentes selon les `événements` - même si les `événements` appartiennent tous à la même `inscription` ou à la même `entité suivie`.

| Propriété | Description | Obligatoire | Immuable | Type | Exemple |
| --- | --- | --- | --- | --- | --- |
| élément de données | L'élément de données que cette valeur représente. | Oui | Oui | Chaîne : Uid | ABCDEF12345 |
| valeur | La valeur de la valeur des données. | Non | Non | Chaîne : Toute | 123 |
| Fourni ailleurs | Indique si l'utilisateur a fourni la valeur ailleurs ou non. Faux si la valeur n'a pas été fournie. | Non | Non | Booléen | Faux ou vrai |
| créé à | Date à laquelle l'utilisateur a ajouté la valeur. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| updatedAt (mis à jour à) | Date de la dernière mise à jour de la valeur. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| Stocké par | Référence client indiquant celui a stocké/créé la valeur. | Non | Non | Chaîne : Toute | John Doe |
| createdBy (créé par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a créé l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |
| updatedBy (mis à jour par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a mis à jour l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |

> **Remarque**
>
> Pour les `éléments de données`, seules les propriétés "élément de données" et "valeur" sont requises lors de l'ajout des données. Une "valeur" peut être nulle, et dans ce cas l'utilisateur doit la supprimer.

### Tracker Notes { #tracker-notes }

Le Tracker de DHIS2 permet de recueillir des données à l'aide d'éléments de données et d'attributs d'entités suivies. Cependant, il est parfois nécessaire d'enregistrer des informations supplémentaires ou des commentaires sur le sujet en question. Ces informations supplémentaires peuvent être saisies à l'aide de notes Tracker. Les notes Tracker correspondent aux commentaires sur les valeurs de données dans DHIS2 Agrégé.

Il existe deux types de notes Tracker : les notes enregistrées au niveau de l'événement et celles enregistrées au niveau de l'inscription. Une inscription peut comporter un ou plusieurs événements. Des commentaires sur chaque événement - par exemple, pourquoi un événement a été manqué, reprogrammé, ou pourquoi seuls quelques éléments de données ont été renseignés et ainsi de suite - peuvent être documentés à l'aide de notes d'événements. Chaque événement d'une inscription peut avoir son propre récit ou ses propres notes. Il est alors possible d'enregistrer, par exemple, une observation générale de ces événements à l'aide de la note d'inscription racine. Les notes d'inscription permettent également de documenter, par exemple, les raisons pour lesquelles une inscription est annulée. C'est à l'utilisateur de faire preuve d'imagination et de déterminer quand et comment utiliser les notes.

Both enrollment and event can have as many notes as needed - there is no limit. However, it is not possible to delete or update neither of these notes. They are like a logbook. If one wants to amend a note, one can do so by creating another note. The only way to delete a note is by deleting the parent object - either event or enrollment.

Les notes Tracker n'ont pas de point d'extrémité qui leur soit dédié. Elles sont échangées dans le cadre de la charge utile de l'événement racine et/ou de l'inscription. Vous trouverez ci-dessous un exemple de charge utile.

```json
{
  "trackedEntityInstance": "oi3PMIGYJH8",
  <entity_details>,
  ],
  "enrollments": [
    {
      "enrollment": "EbRsJr8LSSO",
      <enrollment_details>
      "notes": [
        {
          "note": "vxmCvYcPdaW",
          "value": "Enrollment note 2.",
        },
        {
          "value": "Enrollment note 1",
        }
      ],

      "events": [
        {
          "event": "zfzS9WeO0uM",
          <event_details>,
          "notes": [
            {
              "note": "MAQFb7fAggS",
              "value": "Event Note 1.",
            },
            {
              "value": "Event Note 2.",
            }
          ],
        },
        {
          ...
        }
      ]
    }
  ]
}
```

| Propriété | Description | Obligatoire | Immuable | Type | Exemple |
| --- | --- | --- | --- | --- | --- |
| note | La référence de la note. Elle est générée si rien n'est fourni | Non | Oui | Chaîne : Uid | ABCDEF12345 |
| valeur | Le contenu de la note. | Oui | Oui | Chaîne : Toute | Ceci est une note |
| Stocké à | Date à laquelle l'utilisateur a ajouté la note. Elle est définie sur le serveur. | Non | Oui | Date : ISO 8601 | AAAA-MM-JJThh:mm:ss |
| Stocké par | Référence client indiquant celui a stocké/créé la note. | Non | Non | Chaîne : Toute | John Doe |
| createdBy (créé par) | Uniquement pour lire des données. Il s'agit de l'utilisateur qui a créé l'objet. Défini sur le serveur | Non | Oui | Utilisateur | {<br>"uid": "ABCDEF12345",<br>"Nom d'utilisateur": "Nom d'utilisateur",<br>"Prénom": "John",<br>"Nom de famille": "Doe"<br>} |

### Utilisateur { #user }

| Propriété | Description | Obligatoire | Immuable | Type | Exemple |
| --- | --- | --- | --- | --- | --- |
| uid | L'identifiant de l'utilisateur. | Yes\* | Oui | Chaîne : Uid | ABCDEF12345 |
| Nom d'utilisateur | Le nom d'utilisateur utilisé par l'utilisateur. | Yes\* | Oui | Chaîne : Toute | 123 |
| Prénom | Uniquement pour lire les données. Il s'agit du prénom de l'utilisateur. | Non | Oui | Chaîne : Toute | John |
| Nom de famille | Uniquement pour lire les données. Il s'agit du nom de famille de l'utilisateur. | Non | Oui | Chaîne : Toute | Doe |

> L'`uid` ou le `nom d'utilisateur` doit être fourni. Si les deux sont fournis, seul le nom d’utilisateur est pris en compte.

### Program stage working lists { #webapi_working_list_filters }

The program stage working lists feature within the Capture app is designed to display pre-established working lists relevant to a particular program stage. This functionality enables users to save filters and sorting preferences that are related to program stages, facilitating the organization and management of their workflow. To interact with them, you'll need to use the _/api/programStageWorkingLists_ resource. These lists can be shared and follow the same sharing pattern as any other metadata. When using the _/api/sharing_ the type parameter will be _programStageWorkingLists_.

    /api/40/programStageWorkingLists

##### Payload on CRUD operations to program stage working lists { #payload-on-crud-operations-to-program-stage-working-lists }

The endpoint above can be used to get all program stage working lists. To get a single one, just add at the end the id of the one you are interested in. This is the same in case you want to delete it. On the other hand, if you are looking to create or update a program stage working list, besides the endpoint mentioned above, you'll need to provide a payload in the following format:

Tableau : Charge utile

| Valeurs de charge utile | Description | Exemple |
| --- | --- | --- |
| nom | Nom de la liste de tâches. Obligatoire. |  |
| Description | Il s'agit d'une description de la liste de tâches. |  |
| de paludisme) ». | Objet contenant l'identifiant du programme. Obligatoire. | {"id" : "uy2gU8kTjF"} |
| Étape du programme | Objet contenant l'identifiant de l'étape de programme. Obligatoire. | {"id" : "oRySG82BKE6"} |
| programStageQueryCriteria (Critère de requête de l'étape de programme) | An object representing various possible filtering values. See _Program Stage Query Criteria_ definition table below. |

Table: Program Stage Query Criteria | status | The event status. Possible values are ACTIVE, COMPLETED, VISITED, SCHEDULE, OVERDUE, SKIPPED and VISITED | "status":"VISITED" | | eventCreatedAt | DateFilterPeriod object filtering based on the event creation date. | {"type":"ABSOLUTE","startDate":"2020-03-01","endDate":"2022-12-30"} | | scheduledAt | DateFilterPeriod object filtering based on the event scheduled date. | {"type":"RELATIVE","period":"TODAY"} | | enrollmentStatus | Any valid ProgramStatus. Possible values are ACTIVE, COMPLETED and CANCELLED. | "enrollmentStatus": "COMPLETED" | | enrolledAt | DateFilterPeriod object filtering based on the event enrollment date. | "enrolledAt": {"type":"RELATIVE","period":"THIS_MONTH"} | | enrollmentOccurredAt | DateFilterPeriod object filtering based on the event incident date. | {"type":"RELATIVE","period":"THIS_MONTH"} | | orgUnit | A valid organisation unit UID | "orgUnit": "Rp268JB6Ne4" | | ouMode | A valid OU selection mode | "ouMode": "SELECTED" | | assignedUserMode | A valid user selection mode for events. Possible values are CURRENT, PROVIDED, NONE, ANY and ALL. If PROVIDED (or null), non-empty assignedUsers in the payload will be expected. | "assignedUserMode":"PROVIDED" | | assignedUsers | A list of assigned users for events. To be used along with PROVIDED assignedUserMode above. | "assignedUsers":["DXyJmlo9rge"] | | order | List of fields and its directions in comma separated values, the results will be sorted according to it. A single item in order is of the form "orderDimension:direction". | "order": "w75KJ2mc4zz:asc" | | displayColumnOrder | Output ordering of columns | "displayColumnOrder":["w75KJ2mc4zz","zDhUuAYrxNC"] | | dataFilters | A list of items that contains the filters to be used when querying events | "dataFilters":[{"dataItem": "GXNUsigphqK","ge": "10","le": "20"}] | | attributeValueFilters | A list of attribute value filters. This is used to specify filters for attribute values when listing tracked entity instances | "attributeValueFilters":[{"attribute": "ruQQnf6rswq","eq": "15"}] |

Ci-dessous, un exemple de charge :

```json
{
    "name": "Test WL",
    "program": { "id": "uy2gU8kT1jF" },
    "programStage": { "id": "oRySG82BKE6" },
    "description": "Test WL definition",
    "programStageQueryCriteria": {
        "status": "VISITED",
        "eventCreatedAt": {
            "type": "ABSOLUTE",
            "startDate": "2020-03-01",
            "endDate": "2022-12-30"
        },
        "scheduledAt": { "type": "RELATIVE", "period": "TODAY" },
        "enrollmentStatus": "COMPLETED",
        "enrolledAt": { "type": "RELATIVE", "period": "THIS_MONTH" },
        "enrollmentOccurredAt": { "type": "RELATIVE", "period": "THIS_MONTH" },
        "orgUnit": "Rp268JB6Ne4",
        "ouMode": "SELECTED",
        "assignedUserMode": "PROVIDED",
        "assignedUsers": ["DXyJmlo9rge"],
        "order": "w75KJ2mc4zz:asc",
        "displayColumnOrder": ["w75KJ2mc4zz", "zDhUuAYrxNC"],
        "dataFilters": [
            {
                "dataItem": "GXNUsigphqK",
                "ge": "10",
                "le": "20"
            }
        ],
        "attributeValueFilters": [
            {
                "attribute": "ruQQnf6rswq",
                "eq": "15"
            }
        ]
    }
}
```

## Importation Tracker (`POST /api/tracker`) { #webapi_nti_import }

Le point d'extrémité `POST /api/tracker` permet aux clients d'importer les objets Tracker suivants dans DHIS2 :

-   **Entités suivies**
-   **Inscriptions**
-   **Événements**
-   **Relations**
-   Données intégrées dans d'autres [objets Tracker](#webapi_nti_tracker_objects)

Les principaux changements à noter par rapport aux autres points d'extrémité dédiés à l'importation Tracker sont :

1. Import payload can be **_nested_** or **_flat_**
2. Invocation can be **_synchronous_** or **_asynchronous_**
3. Import **_CSV_** events payload

### Request parameters { #request-parameters }

Actuellement, le point d'extrémité de l'importation Tracker prend en charge les paramètres suivants :

| Le nom du paramètre | Description | Type | Valeurs autorisées |
| --- | --- | --- | --- |
| async | Indique si l’importation doit avoir lieu de manière asynchrone ou synchrone. | Booléen | `VRAI`, `FAUX` |
| Mode de rapport | Uniquement lors d'une importation synchrone. Voir le "Récapitulatif de l'importation" pour plus d’informations. | Énumération | `COMPLET`, `ERREURS`, `AVERTISSEMENTS` |
| Mode d'importation  | Indique le mode d'importation. Peut être validé uniquement (essai à sec) ou validé (par défaut) | Énumération | `VALIDER`, `COMMITER` |
| idScheme | Indique le 'schéma d'identification' global à utiliser pour les références de métadonnées lors de l'importation. La valeur par défaut est UID. Elle peut être remplacée pour des métadonnées spécifiques (voir la liste ci-dessous). | Énumération | `UID`, `CODE`, `NOM`, `ATTRIBUT` |
| dataElementIdScheme (Schéma d'identifiant d'élément de données) | Indique le schéma d'identification à utiliser pour les éléments de données lors de l'importation. | Énumération | `UID`, `CODE`, `NOM`, `ATTRIBUT` |
| orgUnitIdScheme (Schéma de l'identifiant de l'unité d'organisation) | Indique le schéma d'identification à utiliser pour les unités d'organisation lors de l'importation. | Énumération | `UID`, `CODE`, `NOM`, `ATTRIBUT` |
| programIdScheme (Schéma d'identification du programme) | Indique le schéma d'identification à utiliser pour les programmes lors de l'importation. | Énumération | `UID`, `CODE`, `NOM`, `ATTRIBUT` |
| programmeStageIdScheme (Schéma d'identification de l'étape de programme) | Indique le schéma d'identification à utiliser pour les étapes de programme lors de l'importation. | Énumération | `UID`, `CODE`, `NOM`, `ATTRIBUT` |
| categoryOptionComboIdScheme (Schéma de l'identifiant de la combinaison d'options de catégorie) | Indique le schéma d'identification à utiliser pour les combinaisons d'options de catégorie lors de l'importation. | Énumération | `UID`, `CODE`, `NOM`, `ATTRIBUT` |
| categoryOptionIdScheme (Schéma de l'identifiant d'option de catégorie) | Indique le schéma d'identification à utiliser pour les options de catégorie lors de l'importation. | Énumération | `UID`, `CODE`, `NOM`, `ATTRIBUT` |
| importStrategy (stratégie d'importation) | Indique l'effet que l'importation doit avoir. Les différentes possibilités sont `CRÉER`, `METTRE À JOUR`, `CRÉER_ET_METTRE À JOUR` et `SUPPRIMER`. Respectivement, elles permettent d'importer de nouvelles données, d'importer des modifications à des données existantes, d'importer de nouvelles données ou des mises à jour à des données existantes et, enfin, de supprimer des données. | Énumération | `CRÉER`, `METTRE À JOUR`, `CRÉER_ET_METTRE À JOUR` et `SUPPRIMER` |
| Mode atomique | Indique comment l'importation répond aux erreurs de validation. S'il est défini sur `TOUS`, toutes les données importées doivent être valides avant que chaque donnée ne soit commitée. Par contre s'il est défini sur `OBJET`, seules les données commitées doivent être valides, tandis que d'autres données peuvent être invalides. | Énumération | `TOUS`, `OBJET` |
| flushMode | Indique la fréquence de vidange. Il s'agit de la fréquence à laquelle les données sont introduites dans la base de données au cours de l'importation. Il est principalement utilisé à des fins de débogage et ne doit pas être modifié dans un environnement de production. | Énumération | `AUTO`, `OBJECT` |
| Mode de validation | Indique l'intégralité de l'étape de validation. Il peut être ignoré, configuré pour échouer rapidement (retour à la première erreur) ou complet (par défaut), ce qui renverra toutes les erreurs trouvées. | Énumération | `COMPLET`, `ÉCHOUER_RAPIDEMENT`, `IGNORER` |
| Validation du modèle de saut | S'il est défini sur 'vrai', la validation du modèle des attributs générés sera sautée. | Booléen | `VRAI`, `FAUX` |
| Sauter les effets secondaires | Si défini sur 'vrai', les effets secondaires de l'importation seront ignorés. | Booléen | `VRAI`, `FAUX` |
| Sauter les règles | Si défini sur 'vrai', l'exécution des règles de programme pour l'importation sera ignorée. | Booléen | `VRAI`, `FAUX` |

**NOTE**: idScheme and its metadata specific idScheme parameters like orgUnitIdScheme, programIdScheme, ... used to allow and use the default `AUTO`. `AUTO` has been removed. The default idScheme has already been `UID`. Any requests sent with idScheme `AUTO` will see the same behavior as before, namely matching done using `UID`.

### Flat and nested payloads { #flat-and-nested-payloads }

L'importateur prend en charge les charges utiles plates et imbriquées. La principale différence réside dans la manière dont le client exige que ses données soient structurées.

**Flat** : The flat-structured payload is straightforward. It can contain collections for each of the core tracker objects we have. This works seamlessly with existing data, which already have UIDs assigned. However, for new data, the client will have to provide new UIDs for any references between objects. For example, if you import a new tracked entity with a new enrollment, the tracked entity requires the client to provide a UID so that the enrollment can be linked to that UID.

**Nested** : Nested payloads are the most commonly used structure. Here, tracker objects are embedded within their parent object; For example, an enrollment within a tracked entity. The advantage of this structure is that the client does not need to provide UIDs for these connections since they will be given this connection during the import process since they are nested together.

> **REMARQUE**
>
> Même si les charges utiles imbriquées peuvent s'avérer plus simples à gérer pour les clients, elles seront toujours aplaties avant l'importation. Cela signifie que pour les importations volumineuses, le fait de fournir une charge utile plate permettra non seulement d'avoir plus de contrôle mais aussi moins de surcharge sur le processus d'importation.

Ci-dessous, des exemples de versions **PLATES** et **IMBRIQUÉES** de la charge utile. Les mêmes données sont utilisées dans les deux cas.

#### **_FLAT_** payload { #flat-payload }

```json
{
    "trackedEntities": [
        {
            "orgUnit": "O6uvpzGd5pu",
            "trackedEntity": "Kj6vYde4LHh",
            "trackedEntityType": "Q9GufDoplCL"
        }
    ],
    "enrollments": [
        {
            "orgUnit": "O6uvpzGd5pu",
            "program": "f1AyMswryyQ",
            "trackedEntity": "Kj6vYde4LHh",
            "enrollment": "MNWZ6hnuhSw",
            "trackedEntityType": "Q9GufDoplCL",
            "enrolledAt": "2019-08-19T00:00:00.000",
            "deleted": false,
            "occurredAt": "2019-08-19T00:00:00.000",
            "status": "ACTIVE",
            "notes": [],
            "attributes": []
        }
    ],
    "events": [
        {
            "scheduledAt": "2019-08-19T13:59:13.688",
            "program": "f1AyMswryyQ",
            "event": "ZwwuwNp6gVd",
            "programStage": "nlXNK4b7LVr",
            "orgUnit": "O6uvpzGd5pu",
            "trackedEntity": "Kj6vYde4LHh",
            "enrollment": "MNWZ6hnuhSw",
            "enrollmentStatus": "ACTIVE",
            "status": "ACTIVE",
            "occurredAt": "2019-08-01T00:00:00.000",
            "attributeCategoryOptions": "xYerKDKCefk",
            "deleted": false,
            "attributeOptionCombo": "HllvX50cXC0",
            "dataValues": [
                {
                    "updatedAt": "2019-08-19T13:58:37.477",
                    "storedBy": "admin",
                    "dataElement": "BuZ5LGNfGEU",
                    "value": "20",
                    "providedElsewhere": false
                },
                {
                    "updatedAt": "2019-08-19T13:58:40.031",
                    "storedBy": "admin",
                    "dataElement": "ZrqtjjveTFc",
                    "value": "Male",
                    "providedElsewhere": false
                },
                {
                    "updatedAt": "2019-08-19T13:59:13.691",
                    "storedBy": "admin",
                    "dataElement": "mB2QHw1tU96",
                    "value": "[-11.566044,9.477801]",
                    "providedElsewhere": false
                }
            ],
            "notes": []
        },
        {
            "scheduledAt": "2019-08-19T13:59:13.688",
            "program": "f1AyMswryyQ",
            "event": "XwwuwNp6gVE",
            "programStage": "PaOOjwLVW23",
            "orgUnit": "O6uvpzGd5pu",
            "trackedEntity": "Kj6vYde4LHh",
            "enrollment": "MNWZ6hnuhSw",
            "enrollmentStatus": "ACTIVE",
            "status": "ACTIVE",
            "occurredAt": "2019-08-01T00:00:00.000",
            "attributeCategoryOptions": "xYerKDKCefk",
            "deleted": false,
            "attributeOptionCombo": "HllvX50cXC0",
            "notes": []
        }
    ],
    "relationships": [
        {
            "relationshipType": "Udhj3bsdHeT",
            "from": {
                "trackedEntity": { "trackedEntity": "Kj6vYde4LHh" }
            },
            "to": {
                "trackedEntity": { "trackedEntity": "Gjaiu3ea38E" }
            }
        }
    ]
}
```

#### **_NESTED_** payload { #nested-payload }

```json
{
    "trackedEntities": [
        {
            "orgUnit": "O6uvpzGd5pu",
            "trackedEntity": "Kj6vYde4LHh",
            "trackedEntityType": "Q9GufDoplCL",
            "relationships": [
                {
                    "relationshipType": "Udhj3bsdHeT",
                    "from": {
                        "trackedEntity": { "trackedEntity": "Kj6vYde4LHh" }
                    },
                    "to": {
                        "trackedEntity": { "trackedEntity": "Gjaiu3ea38E" }
                    }
                }
            ],
            "enrollments": [
                {
                    "orgUnit": "O6uvpzGd5pu",
                    "program": "f1AyMswryyQ",
                    "trackedEntity": "Kj6vYde4LHh",
                    "enrollment": "MNWZ6hnuhSw",
                    "trackedEntityType": "Q9GufDoplCL",
                    "enrolledAt": "2019-08-19T00:00:00.000",
                    "deleted": false,
                    "occurredAt": "2019-08-19T00:00:00.000",
                    "status": "ACTIVE",
                    "notes": [],
                    "relationships": [],
                    "attributes": [],
                    "events": [
                        {
                            "scheduledAt": "2019-08-19T13:59:13.688",
                            "program": "f1AyMswryyQ",
                            "event": "ZwwuwNp6gVd",
                            "programStage": "nlXNK4b7LVr",
                            "orgUnit": "O6uvpzGd5pu",
                            "trackedEntity": "Kj6vYde4LHh",
                            "enrollment": "MNWZ6hnuhSw",
                            "enrollmentStatus": "ACTIVE",
                            "status": "ACTIVE",
                            "occurredAt": "2019-08-01T00:00:00.000",
                            "attributeCategoryOptions": "xYerKDKCefk",
                            "deleted": false,
                            "attributeOptionCombo": "HllvX50cXC0",
                            "dataValues": [
                                {
                                    "updatedAt": "2019-08-19T13:58:37.477",
                                    "storedBy": "admin",
                                    "dataElement": "BuZ5LGNfGEU",
                                    "value": "20",
                                    "providedElsewhere": false
                                },
                                {
                                    "updatedAt": "2019-08-19T13:58:40.031",
                                    "storedBy": "admin",
                                    "dataElement": "ZrqtjjveTFc",
                                    "value": "Male",
                                    "providedElsewhere": false
                                },
                                {
                                    "updatedAt": "2019-08-19T13:59:13.691",
                                    "storedBy": "admin",
                                    "dataElement": "mB2QHw1tU96",
                                    "value": "[-11.566044,9.477801]",
                                    "providedElsewhere": false
                                }
                            ],
                            "notes": [],
                            "relationships": []
                        },
                        {
                            "scheduledAt": "2019-08-19T13:59:13.688",
                            "program": "f1AyMswryyQ",
                            "event": "XwwuwNp6gVE",
                            "programStage": "PaOOjwLVW23",
                            "orgUnit": "O6uvpzGd5pu",
                            "trackedEntity": "Kj6vYde4LHh",
                            "enrollment": "MNWZ6hnuhSw",
                            "enrollmentStatus": "ACTIVE",
                            "status": "ACTIVE",
                            "occurredAt": "2019-08-01T00:00:00.000",
                            "attributeCategoryOptions": "xYerKDKCefk",
                            "deleted": false,
                            "attributeOptionCombo": "HllvX50cXC0",
                            "notes": [],
                            "relationships": []
                        }
                    ]
                }
            ]
        }
    ]
}
```

### SYNC and ASYNC { #sync-and-async }

Pour l'utilisateur, la principale différence entre une importation synchrone et une importation asynchrone est la réponse immédiate de l'API. Dans le cas d'une importation synchrone, la réponse sera renvoyée avec le récapitulatif de l'importation (importSummary) dès que l'importation sera terminée. En revanche, pour les importations asynchrones, la réponse sera immédiate et contiendra une référence à travers laquelle le client pourra demander des mises à jour de l'importation.

Dles importations importantes, il peut être avantageux pour le client d'utiliser l'importation asynchrone pour éviter d'attendre trop longtemps une réponse.

Des exemples de réponse **ASYNC** sont présentés ci-dessous. Pour la réponse **SYNC**, consultez la [section importSummary](#webapi_nti_import_summary).

```json
{
    "httpStatus": "OK",
    "httpStatusCode": 200,
    "status": "OK",
    "message": "Tracker job added",
    "response": {
        "responseType": "TrackerJob",
        "id": "LkXBUdIgbe3",
        "location": "https://play.dhis2.org/dev/api/tracker/jobs/LkXBUdIgbe3"
    }
}
```

### CSV Events payload { #csv-events-payload }

In order to maintain compatibility with older versions of tracker, the API allows to import events using the CSV format. As this format does not allow list as field, every row of the CSV payload represents an event and a data value. So for events with multiple data values, the CSV file will have `x` rows per event where `x` is the number of data values in that event. Other fields that are lists as **_relationships_** and **_notes_** are not supported. To import a CSV payload, the content type of the request must be set to **_application/csv_** or **_text/csv_**.

#### **_CSV PAYLOAD_** example { #csv-payload-example }

| événement | statut | de paludisme) ». | Étape du programme | inscription | orgUnit (Unité d'organisation) | occurredAt (s'est produit à) | scheduledAt (programmé à) | élément de données | valeur | Stocké par | Fourni ailleurs |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| V1CerIi3sdL | EFFECTUÉ | IpHINAT79UW | A03MvHHogjR | CCBLMntFuzb | DiszpKrYNg8 | 2020-02-26T23:00:00Z | 2020-02-27T23:00:00Z | a3kGcGDCuk6 | 11 | admin | faux |
| V1CerIi3sdL | EFFECTUÉ | IpHINAT79UW | A03MvHHogjR | CCBLMntFuzb | DiszpKrYNg8 | 2020-02-26T23:00:00Z | 2020-02-27T23:00:00Z | mB2QHw1tU96 | [-11.566044,9.477801] | admin | faux |

### Récapitulatif des importations { #webapi_nti_import_summary }

L'API du Tracker dispose de deux points d'extrémité de base qui permettent aux consommateurs d'obtenir des commentaires sur leurs importations. Ces points d'extrémité concernent plus les tâches d'importation asynchrone, mais ils sont également disponibles pour les importations synchrones. Ces points d'extrémité renverront soit le journal de l'importation, soit le récapitulatif de l'importation lui-même.

> **Remarque**
>
> Ces points d'extrémité s'appuient sur des informations stockées dans la mémoire de l'application. Cela signifie que les informations seront indisponibles après certaines situations, telle qu'un redémarrage de l'application ou après un grand nombre de requêtes d'importation qui commencent après celle-ci.

Après avoir soumis une requête d'importation Tracker, nous pouvons accéder aux points d'extrémité suivants afin de surveiller la progression de la tâche en fonction des journaux :

`GET /tracker/jobs/{uid}`

| Paramètre | Description                               | Exemple     |
| --------- | ----------------------------------------- | ----------- |
| `{uid}`   | L'UID d'une tâche d'importation Tracker existante | ABCDEF12345 |

#### **_REQUEST_** example { #request-example }

`GET /tracker/jobs/mEfEaFSCKCC`

#### **_RESPONSE_** example { #response-example }

```json
[
    {
        "uid": "mEfEaFSCKCC",
        "level": "INFO",
        "category": "TRACKER_IMPORT_JOB",
        "time": "2021-01-01T00:00:06.00",
        "message": "TRACKER_IMPORT_JOB ( mEfEaFSCKCC ) finished in 6.00000 sec. Import:Done",
        "completed": true,
        "id": "mEfEaFSCKCC"
    },
    {
        "uid": "mEfEaFSCKCC",
        "level": "DEBUG",
        "category": "TRACKER_IMPORT_JOB",
        "time": "2021-01-01T00:00:05.00",
        "message": "TRACKER_IMPORT_JOB ( mEfEaFSCKCC ) commit completed in 1.00000 sec. Import:commit",
        "completed": true,
        "id": "mEfEaFSCKCC"
    },
    {
        "uid": "mEfEaFSCKCC",
        "level": "DEBUG",
        "category": "TRACKER_IMPORT_JOB",
        "time": "2021-01-01T00:00:04.00",
        "message": "TRACKER_IMPORT_JOB ( mEfEaFSCKCC ) programruleValidation completed in 1.00000 sec. Import:programruleValidation",
        "completed": true,
        "id": "mEfEaFSCKCC"
    },
    {
        "uid": "mEfEaFSCKCC",
        "level": "DEBUG",
        "category": "TRACKER_IMPORT_JOB",
        "time": "2021-01-01T00:00:03.00",
        "message": "TRACKER_IMPORT_JOB ( mEfEaFSCKCC ) programrule completed in 1.00000 sec. Import:programrule",
        "completed": true,
        "id": "mEfEaFSCKCC"
    },
    {
        "uid": "mEfEaFSCKCC",
        "level": "DEBUG",
        "category": "TRACKER_IMPORT_JOB",
        "time": "2021-01-01T00:00:02.00",
        "message": "TRACKER_IMPORT_JOB ( mEfEaFSCKCC ) validation completed in 1.00000 sec. Import:validation",
        "completed": true,
        "id": "mEfEaFSCKCC"
    },
    {
        "uid": "mEfEaFSCKCC",
        "level": "DEBUG",
        "category": "TRACKER_IMPORT_JOB",
        "time": "2021-01-01T00:00:01.00",
        "message": "TRACKER_IMPORT_JOB ( mEfEaFSCKCC ) preheat completed in 1.00000 sec. Import:preheat",
        "completed": true,
        "id": "mEfEaFSCKCC"
    },
    {
        "uid": "mEfEaFSCKCC",
        "level": "INFO",
        "category": "TRACKER_IMPORT_JOB",
        "time": "2021-01-01T00:00:00.00",
        "message": "TRACKER_IMPORT_JOB ( mEfEaFSCKCC ) started by admin ( xE7jOejl9FI ) Import:Start",
        "completed": true,
        "id": "mEfEaFSCKCC"
    }
]
```

De plus, le point d'extrémité suivant renverra le récapitulatif de la tâche d’importation. Ce récapitulatif ne sera disponible qu'une fois l'importation terminée :

`GET /tracker/jobs/{uid}/report`

| Paramètre | Description | Exemple |
| --- | --- | --- |
| path `/{uid}` | L'UID d'une tâche d'importation Tracker existante | ABCDEF12345 |
| `reportMode` (Mode de rapport) | Le niveau du rapport à renvoyer | `FULL`&#124;`ERRORS`&#124;`WARNINGS` |

#### **_REQUEST_** example { #request-example }

`GET /tracker/jobs/mEfEaFSCKCC/report`

#### **_RESPONSE_** example { #response-example }

La [charge utile de la réponse](#sample-responses) est la même que celle renvoyée après une requête d'importation synchrone.

> **Remarque**
>
> Les deux points d'extrémité sont principalement utilisés pour l'importation asynchrone. Cependant, `GET /tracker/jobs/{uid}` devrait également fonctionner pour les demandes synchrones car au final il utilise le même processus d'importation et la même journalisation que les demandes asynchrones.

### Import Summary Structure { #import-summary-structure }

La structure globale des récapitulatifs d'importation se présente comme suit, en fonction du `mode de rapport` faisant l'objet de la requête :

```json
{
    "status": "...",
    "validationReport": {},
    "stats": {},
    "timingsStats": {},
    "bundleReport": {},
    "message": {}
}
```

**_status_**

La propriété `statut` du récapitulatif d'importation indique l'état global de l'importation. Si aucune erreur ou avertissement n'est signalé(e) lors de l'importation, le `statut` est `OK`. Par contre, si une erreur ou un avertissement est signalé(e) lors de l'importation, le statut devient `ERREUR` ou `AVERTISSEMENT`.

Le `statut` dépend du `Rapport de validation` le plus important. `ERREUR` est le plus important, suivi de `AVERTISSEMENT` et enfin `OK`. Cela implique que `ERREUR` est signalé si une seule erreur a été détectée lors de l'importation, quel que soit le nombre d'avertissements.

> **Remarque**
>
> Si l'importation est faite selon le mode atomique "OBJET", où les données sont importées sans erreurs de validation, le statut sera toujours `ERREUR` si des erreurs sont détectées.

**_validationReport_**

Le `Rapport de validation` peut inclure des `Rapports d'erreur` et des `Rapports d'avertissement` si des erreurs ou des avertissements étaient présents lors de l'importation. Lorsqu'ils sont présents, ils fournissent une liste détaillée des erreurs ou avertissements rencontrés.

Ci-dessous, un exemple d'erreur de validation lors de l'importation d'une `ENTIÉE_SUIVIE` :

```json
{
  "validationReport": {
    "errorReports": [
      {
        "message": "Could not find TrackedEntityType: `Q9GufDoplCL`.",
        "errorCode": "E1005",
        "trackerType": "TRACKED_ENTITY",
        "uid": "Kj6vYde4LHh"
      },
      ...
    ],
    "warningReports" : [ ... ]
  }
}
```

Le rapport contient un message et un code décrivant l'erreur (voir la section [codes d'erreur] (#error-codes) pour plus d'informations sur les erreurs). Il contient également le `type de tracker` et l'`uid`, lesquels permettent d'identifier l'emplacement de l'erreur dans les données. Dans ce cas, il y avait une `ENTITÉ_SUIVIE` avec l'uid `Kj6vYde4LHh` qui renvoyait à un type d'entité suivi qui n'a pas été trouvé.

> **Remarque**
>
> Les `uid` des objets trackers servent de noms à ces objets dans la charge utile. Par exemple, l'`uid` d'une entité suivie dans la charge utile serait "trackedEntity". La même chose s'applique aux inscriptions, aux événements et aux relations qui portent respectivement les noms "enrollment", "event" et "relationship".
>
> Si aucun uid n'est fourni dans la charge utile, le processus d'importation générera de nouveaux uids. Cela signifie que le rapport d'erreur peut faire référence à un uid qui n'existe pas dans votre charge utile.
>
> Les erreurs signalent des problèmes avec la charge utile que l'importateur ne peut pas contourner. Toute erreur empêchera l'importation de ces données. Les avertissements, en revanche, sont des problèmes qui peuvent être contournés en toute sécurité, mais dont l'utilisateur doit être informé. Les avertissements ne bloquent pas l'importation des données.

**_stats_**

Les statistiques donnent un aperçu rapide de l'importation. Une fois l'importation terminée, ces statistiques indiqueront la quantité de données créées, mises à jour, supprimées ou ignorées.

Exemple:

```json
{
    "stats": {
        "created": 2,
        "updated": 2,
        "deleted": 1,
        "ignored": 5,
        "total": 10
    }
}
```

`cre` fait référence au nombre de nouveaux objets créés. En général, les objets sans UID existant dans la charge utile seront traités comme de nouveaux objets.

`updated` fait référence au nombre d'objets mis à jour. Si un objet a un UID défini dans la charge utile, il sera considéré comme étant à jour tant que ce même UID se trouve dans la base de données.

`deleted` fait référence au nombre d'objets supprimés lors de l'importation. La suppression ne se produit que lorsque l'importation est configurée pour supprimer des données et uniquement lorsque les objets présents dans la charge utile ont des UID existants définis.

`ignored` fait référence aux objets qui n'ont pas été conservés. Les objets peuvent être ignorés pour plusieurs raisons, par exemple pour éviter de créer un objet qui existe déjà. Ignorer des objets ne pose pas de réels problèmes, car si un objet est ignoré, c'est parce que sa création n'était pas nécessaire ou cela lié à la configuration de l'importation.

**_timingsStats_**

`timingStats` représente le temps écoulé dans les différentes étapes de l'importation. Ces statistiques ne donnent pas le temps total exact de l'importation, mais plutôt le temps passé dans le code pour les différentes étapes.

Les `timingStats` servent principalement à déboguer les importations qui posent des problèmes afin de voir quelle partie de l'importation rencontre des problèmes.

```json
{
  "timingsStats": {
    "timers": {
      "preheat": "0.234086 sec.",
      "preprocess": "0.000058 sec.",
      ...
      "totalImport": "0.236810 sec.",
      "validation": "0.001533 sec."
    }
  }
}
```

**_bundleReport_**

Une fois l'importation terminée, le `bundleReport` contient tous les [objets tracker](#tracker-objects) importés.

Prenons en exemple l'`ENTITÉ_SUIVIE` :

```json
{
  "bundleReport": {
    "typeReportMap": {
      "TRACKED_ENTITY": {
        "trackerType": "TRACKED_ENTITY",
        "stats": {
          "created": 1,
          "updated": 0,
          "deleted": 0,
          "ignored": 0,
          "total": 1
        },
        "objectReports": [
          {
            "trackerType": "TRACKED_ENTITY",
            "uid": "FkxTQC4EAKK",
            "index": 0,
            "errorReports": []
          }
        ]
      },
      ...
    }
  }
}
```

Comme nous l'avons vu, chaque type d'objet Tracker sera rapporté, et chacun a ses propres statistiques et `objectReports`(rapports d'objets). Ces `rapports d'objets` fourniront des détails sur chaque objet importé, notamment leur type, leur UID et tout rapport d'erreur ou d'avertissement qui les concerne.

**_message_**

Si l'importation se termine brusquement, le `message`  va contenir des informations supplémentaires sur ce qui s'est passé.

### Import Summary Report Level { #import-summary-report-level }

Comme indiqué précédemment, `GET /tracker/jobs/{uid}/report` peut être récupéré à l'aide d'un paramètre `reportMode` spécifique. Par défaut, le point d'extrémité renverra un `importSummary` avec `pour reportMode` `ERROR`.

| Paramètre | Description |
| --- | --- |
| `COMPLET` | Renvoie tout à partir de `AVERTISSEMENTS`, en plus des `timingsStats` |
| `AVERTISSEMENTS` | Renvoie tout à partir de `ERREURS`, en plus de `warningReports` (rapports d'avertissement) dans `validationReports` (rapports de validation) |
| `ERREURS` (par défaut) | Renvoie uniquement `errorReports` (rapports d'erreurs) dans `validationReports` |

De plus, tous les `reportModes` (modes de rapports) renverront `statut`, `statistiques`, `bundleReport` et `message` le cas échéant.

### Codes d'erreur { #webapi_nti_error_codes }

Il existe plusieurs codes d'erreur pour différents scénarios d'erreur. Le tableau suivant contient la liste des codes d'erreur générés par la nouvelle API du Tracker, ainsi que les messages d'erreur et quelques descriptions supplémentaires. Les espaces réservés dans les messages d'erreur (`{0}`, `{1}`, `{2}`..) sont généralement des uids, sauf indication contraire.

| Code d'erreur | Message d'erreur | Description |
| :-- | :-- | :-- |
| E1000 | Utilisateur : `{0}`, n'a pas d'accès en écriture à l'unité d'organisation : `{1}`. | Cela signifie que l'unité d'organisation `{1}` ne fait pas partie du champ de saisie de l'utilisateur `{0}` pour que l'opération d'écriture soit autorisée. |
| E1001 | L'utilisateur : `{0}`, n'a pas d'accès en écriture de données sur le type d'entité suivie : `{1}`. | The error occurs when the user is not authorized to create or modify data of the TrackedEntityType `{1}` |
| E1002 | L'instance d'entité suivie `{0}` existe déjà. | Cette erreur se produit lorsque l'on essaie de créer une nouvelle entité suivie avec un uid déjà existant. Veillez à utiliser un nouvel uid lors de l'ajout d'une nouvelle entité suivie. |
| E1005 | Impossible de trouver le Type d'entité suivie : `{0}`. | L'erreur se produit lorsque l'on essaie de récupérer un Type d'entité suivie non existant avec l'uid `{0}` . Cela peut également signifier que l'utilisateur n'a pas d'accès en lecture au Type d'entité suivie. |
| E1006 | L'attribut : `{0}` n'existe pas. | L'erreur se produit lorsque le système n'a pas pu trouver un attribut d'entité suivie correspondant avec l'uid `{0}`. Cela peut également signifier que l'utilisateur n'a pas accès à l'attribut d'entité suivie. |
| E1007 | Erreur de validation du type de valeur d'attribut : `{0}` ; Erreur : `{1}`. | Incompatibilité entre le type de valeur d'un attribut d'entité suivie et la valeur d'attribut qui lui est fournie. L'erreur de validation réelle sera affichée dans `{1}`. |
| E1009 | Le ressource de fichier : `{0}` a déjà été attribuée à un autre objet. | L'uid de ressource de fichier `{0}` est déjà attribué à un autre objet du système. |
| E1010 | Impossible de trouver le programme : `{0}` lié à l'événement. | Le système n'a pas pu trouver un programme avec l'uid `{0}` spécifié dans la charge utile Événement. Cela peut également signifier que le programme spécifique n'est pas accessible par l'utilisateur connecté. |
| E1011 | Impossible de trouver l'unité d'organisation : `{0}` lié à l'événement. | Le système n'a pas pu trouver une unité d'organisation avec l'uid `{0}` spécifié dans la charge utile de l'événement. |
| E1012 | La géométrie n'est pas conforme au FeatureType (type de fonctionnalité) : `{0}`. | Le type de fonctionnalité fourni est soit NONE (aucun), soit il est incompatible pour la valeur géométrique fournie. |
| E1013 | Impossible de trouver le ProgramStage (étape de programme) : `{0}`, lié à l'événement. | Le système n'a pas pu trouver une étape de programme avec l'uid `{0}` spécifié dans la charge utile de l'événement. Cela peut également signifier que l'étape de programme n'est pas accessible à l'utilisateur connecté. |
| E1014 | Un programme identifié `{0}` est un programme sans enregistrement. Aucune inscription ne peut être faite dans un programme sans enregistrement. | Les inscriptions ne peuvent être créées que pour les programmes avec des enregistrements. |
| E1015 | L'instance d'entité suivie : `{0}` a déjà une inscription active dans le programme `{1}`. | Il est impossible de s'inscrire à un programme si une autre inscription active existe déjà pour le programme. L’inscription active devra au moins être terminée au préalable. |
| E1016 | L'instance d'entité suivie : `{0}` a déjà une inscription active dans le programme : `{1}`, et ce programme n'autorise qu'une seule inscription . | Conformément à la configuration du programme `{1}`, une entité suivie ne peut être inscrite qu'une seule fois à ce programme. Il semble que l'entité suivie `{0}` ait déjà une inscription ACTIVE ou TERMINÉE dans ce programme. Une autre inscription ne peut donc pas être ajoutée. |
| E1018 | L'attribut : `{0}` est obligatoire dans le programme `{1}` mais il n'est pas déclaré dans l'inscription `{2}`. | La valeur de l'attribut est manquante dans la charge utile, pour un attribut défini comme obligatoire pour un programme. Assurez-vous que les valeurs des attributs obligatoires sont fournies dans la charge utile. |
| E1019 | Only Program attributes is allowed for enrollment; Non valid attribute: `{0}`. | L'uid d'attribut `{0}` spécifié dans la charge utile d'inscription n'est pas associé au programme. |
| E1020 | La date d'inscription : `{0}` ne peut pas être une date ultérieure.` | Il est impossible de créer une inscription à une date ultérieure à moins que le Programme ne le permette dans sa configuration. |
| E1021 | La date d'incidence identifiée `{0}` ne peut pas être une date ultérieure.` | La date d'incidence ne peut pas être une date ultérieure à moins que le Programme ne le permette dans sa configuration. |
| E1022 | L'instance d'entité suivie `{0}` doit avoir le même type d'entité suivie que le programme `{1}`. | Le programme est configuré pour accepter un UID de type d'entité suivie différent de celui fourni dans la charge utile d’inscription. |
| E1023 | La DisplayIncidentDate (date d'affichage de l'incident) est vraie mais la propriété occurredAt (survenu à) est nulle ou a un format invalide : `{0}`. | Le programme est configuré avec la date d'affichage de l'incident mais sa date est nulle ou invalide dans la charge utile. |
| E1025 | La propriété enrolledAt (inscrit à) est nulle ou a un format non valide : `{0}`. | La date d'inscription est obligatoire pour une inscription. Assurez-vous qu'il ne soit pas nul et qu'il ait un format de date valide. |
| E1029 | L'unité d'organisation Évènement identifiée `{0}` et le Programme `{1}` ne correspondent pas. | La charge utile de l'événement utilise un programme `{1}` qui n'est pas configuré pour être accessible par l'unité d'organisation `{0}`. |
| E1030 | L'Événement `{0}` existe déjà. | Cette erreur se produit lorsque l'on essaie d'ajouter un nouvel événement avec un uid déjà existant. Veillez à utiliser un nouvel uid lors de l'ajout d'un nouvel événement. |
| E1031 | La date à laquelle l'événement est survenu (OccurredAt) est manquante. | La propriété OccuredAt (est survenue) est nulle ou a un format de date invalide dans la charge utile. |
| E1032 | L'Événement `{0}` n'existe pas. |  |
| E1033 | La valeur d'inscription de l'Événement `{0}`  est NULLE. |  |
| E1035 | La valeur d'inscription de l'Étape de programme `{0}`  est NULLE. |  |
| E1036 | L'instance d'entité suivie de l'Événement `{0}` ne pointe pas vers un objet existant. | Le système n'a pas pu trouver une entité suivie avec l'UID spécifié dans la charge utile de l'événement. Cela peut également signifier que l'utilisateur n'a pas d'accès en lecture à l'entité suivie. |
| E1039 | L'Étape de programme `{0}` n'est pas répétable et un événement existe déjà. | Un événement existe déjà pour l'étape de programme de l’inscription. Étant donné que l'étape de programme est configuré pour être non répétable, un autre événement ne peut pas être ajouté pour la même étape de programme. |
| E1041 | L'unité d'organisation Inscription `{0}` et le Programme `{1}` ne correspondent pas. | The Enrollment payload contains a Program `{1}` which is not configured to be accessible by the OrganisationUnit `{0}`. |
| E1042 | L'Événement `{0}` doit avoir une date de fin. | Si le programme est configuré pour avoir des completeExpiryDays (dates d'expiration complètes), alors la date de fin est obligatoire pour la charge utile d'un événement TERMINÉ. La propriété "completedDate" d'un événement dont le statut est "COMPLETED" (TERMINÉ) doit être non nulle et correspondre à un format de date valide. |
| E1048 | Object: `{0}`, uid: `{1}`, has an invalid uid format. | Un uid valide comporte 11 caractères. Le premier caractère doit être une lettre de l'alphabet (a-z ou A-Z) et les 10 caractères restants peuvent être alphanumériques (a-z ou A-Z ou 0-9). |
| E1049 | Could not find OrganisationUnit: `{0}`, linked to Tracked Entity. | The system could not find an OrganisationUnit with uid `{0}`. |
| E1050 | La date à laquelle l'événement est programmé (ScheduledAt) est manquante. | La propriété "ScheduledAt" dans la charge utile de l'événement est soit manquante, soit son format de date est invalide. |
| E1055 | La combinaison d'options d'attribut (AttributeOptionCombo) par défaut n'est pas autorisée car le programme n'a pas de combinaison de catégories (CategoryCombo) par défaut. | Le programme est configuré pour contenir une combinaison de catégories différente de celle par défaut, mais la requête utilise la combinaison d'options d'attribut par défaut. |
| E1056 | La date d'événement : `{0}`, est antérieure à la date de début : `{1}`, pour l'option d'attribut (AttributeOption) : `{2}`. | L'option de catégorie a une date de début configurée ; la date de l'événement dans la charge utile ne peut pas être antérieure à cette date de début. |
| E1057 | La date d'événement : `{0}`, est postérieure à la date de début : `{1}`, pour l'option d'attribut (AttributeOption) : `{2}`. | L'option de catégorie a une date de fin configurée ; la date de l'événement dans la charge utile ne peut pas être postérieure à cette date de fin. |
| E1063 | L'instance d'entité suivie `{0}` n'existe pas. | L'erreur se produit lorsque l'on essaie de récupérer une Entité suivie qui n'existe pas avec l'uid `{0}`. Cela peut également signifier que l'utilisateur n'a pas d'accès en lecture à l'Entité suivie. |
| E1064 | Valeur d'attribut non unique `{0}` pour l'attribut `{1}` | La valeur de l'attribut doit être unique dans le champ d'application défini. L'erreur indique que la valeur de l'attribut existe déjà pour une autre Entité suivie. |
| E1068 | Impossible de trouver l'Instance d'entité suivie : `{0}`, lié à l'inscription. | Le système n'a pas pu trouver l'entité suivie spécifiée dans la charge utile d'inscription. Cela peut également signifier que l'utilisateur n'a pas d'accès en lecture à cette entité suivie. |
| E1069 | Impossible de trouver le programme : `{0}` lié à l'inscription. | Le système n'a pas pu trouver le programme spécifié dans la charge utile d'inscription. Cela peut également signifier que l'utilisateur n'a pas d'accès en lecture à cet programme . |
| E1070 | Impossible de trouver l'unité d'organisation : `{0}` lié à l'inscription. | Le système n'a pas pu trouver l'unité d'organisation spécifiée dans la charge utile d'inscription. |
| E1074 | FeatureType (Type de fonctionnalité) est manquant. |  |
| E1075 | L'attribut : `{0}`, n'a pas d'uid. |  |
| E1076 | `{0}` `{1}` est obligatoire et ne peut pas être nul |  |
| E1077 | La valeur du texte de l'attribut : `{0}`, dépasse la longueur maximale autorisée : `{0}`. |  |
| E1080 | L'Inscription `{0}` existe déjà. | Cette erreur se produit lorsque l'on essaie de créer une nouvelle inscription avec un uid déjà existant. Veillez à utiliser un nouvel uid pour une nouvelle inscription. |
| E1081 | L'Inscription `{0}` n'existe pas. | L'erreur se produit lorsque l'on essaie de récupérer une Inscription qui n'existe pas avec l'uid `{0}`. Cela peut également signifier que l'utilisateur n'a pas d'accès en lecture à cette Inscription. |
| E1082 | L'Événement : `{0}`, est déjà supprimé et ne peut pas être modifié. | Si l’événement est supprimé mais pas définitivement (soft delete), aucune modification n’est autorisée sur cet événement. |
| E1083 | L'Utilisateur : `{0}`, n'est pas autorisé à modifier les événements terminés. | Seul un super utilisateur ou un utilisateur disposant de l'autorité "F_UNCOMPLETE_EVENT" peut modifier les événements terminés. Les événements terminés sont les événements dont le statut est "TERMINÉ". |
| E1084 | La référence de la ressource de fichier : `{0}`, est introuvable. |  |
| E1085 | La valeur de l'Attribut : `{0}`, ne correspond pas au type de valeur : `{1}`. | Incompatibilité entre le type de valeur d'un attribut et la valeur d'attribut fournie. |
| E1089 | L'Événement : `{0}`, fait référence à une Étape de programme `{1}` qui n'appartient pas au Programme `{2}`. | L’uid de l'Étape de programme et l’uid de Programme présent dans la charge utile de l’Événement sont incompatibles. |
| E1090 | L'attribut : `{0}` est obligatoire dans le type d'entité suivie `{1}` mais il n'est pas déclaré dans l'entité suivie `{2}`. | Des valeurs manquent dans la charge utile pour les attributs de type d'entité suivie obligatoires. |
| E1091 | L'utilisateur : `{0}` n'a pas d'accès en écriture de données sur le Programme : `{1}`. | La configuration du partage du Programme est telle que l'utilisateur n'a pas d'accès en écriture pour ce programme. |
| E1095 | L'utilisateur : `{0}` n'a pas d'accès en écriture de données sur l'Étape de programme : `{1}`. | La configuration du partage de l'Étape de programme est telle que l'utilisateur n'a pas d'accès en écriture pour cette Étape de programme. |
| E1096 | L'utilisateur : `{0}` n'a pas d'accès en lecture de données sur le Programme : `{1}`. | La configuration du partage du Programme est telle que l'utilisateur n'a pas d'accès en lecture pour ce programme. |
| E1099 | L'utilisateur : `{0}` n'a pas d'accès en écriture sur l'Option de catégorie : `{1}`. | La configuration du partage de l'Option de catégorie est telle que l'utilisateur n'a pas d'accès en écriture pour cette Option de catégorie. |
| E1100 | L'Utilisateur : `{0}`, ne dispose pas de l'autorité 'F_TEI_CASCADE_DELETE' pour supprimer l'Instance d'entité suivie : `{1}`. | Certaines Inscriptions n'ont pas été supprimées pour cette Entité suivie. Si l'utilisateur ne dispose pas de l'autorité "F_TEI_CASCADE_DELETE", ces inscriptions devront d'abord être supprimées explicitement avant qu'il puisse supprimer l'Entité suivie. |
| E1102 | L'Utilisateur : `{0}`, n'a pas accès à la combinaison de l'Entité suivie : `{1}` et du Programme : `{2}`. | Cette erreur se produit lorsque l'unité d'organisation de l'utilisateur ne possède pas cette entité suivie, pour ce programme spécifique. L'unité d'organisation propriétaire de la combinaison Entité Suivie-Programme (TrackedEntity-Program) doit se trouver dans le champ de saisie (dans certains cas, dans le champ de recherche) de l'utilisateur. |
| E1103 | L'Utilisateur : `{0}`, ne dispose pas de l'autorité 'F_ENROLLMENT_CASCADE_DELETE' pour supprimer l'Inscription : `{1}`. | Certains Événements n'ont pas été supprimées pour cette Inscription. Si l'utilisateur ne dispose pas de l'autorité 'F_ENROLLMENT_CASCADE_DELETE', ces Événements devront d'abord être supprimées explicitement avant qu'il puisse supprimer l'Inscription. |
| E1104 | L'utilisateur : `{0}` n'a pas d'accès en lecture de données sur le programme : `{1}` et le type d'entité suivie : `{2}`. | La configuration du partage du Type d'entité suivie associé au Programme est telle que l'utilisateur n'a pas d'accès en lecture de données pour ce type d'entité suivie. |
| E1112 | La Valeur d'attribut : `{0}`, est définie sur 'confidentiel' mais le système n'est pas correctement configuré pour crypter les données. | Soit les fichiers JCE sont manquants, soit la propriété de configuration `encryption.password` peut être manquante dans `dhis.conf`. |
| E1113 | L'Inscription : `{0}`, est déjà supprimée et ne peut plus être modifiée. | Si l'inscription est supprimée mais pas définitivement (soft delete), aucune modification n’est autorisée sur cette inscription. |
| E1114 | L'Entité suivie : `{0}`, est déjà supprimée et ne peut donc plus être modifiée. | Si l'entité suivie est supprimée mais pas définitivement (soft delete), aucune modification n’est autorisée sur cette entité suivie. |
| E1115 | Impossible de trouver la combinaison d'options de catégorie : `{0}`. |  |
| E1116 | Impossible de trouver la l'Option de catégorie : `{0}`. | Cela peut également signifier que l'utilisateur n'a pas accès à cette option de catégorie. |
| E1117 | La Combinaison d'options de catégorie n'existe pas pour la combinaison de catégories et les options de catégorie fournies : `{0}`. |  |
| E1118 | L'utilisateur attribué `{0}` n'est pas un uid valide. |  |
| E1119 | Une note de Tracker avec l'uid `{0}` existe déjà. |  |
| E1120 | L'Étape de programme `{0}` n'autorise pas l'attribution d'utilisateurs | La charge utile d'événement a attribué un identifiant d'utilisateur (uid) mais l'étape de programme n’est pas configurée pour autoriser l'attribution d’utilisateurs. |
| E1121 | Propriété d'entité suivie obligatoire manquante : `{0}`. |  |
| E1122 | La propriété d'inscription requise est manquante : `{0}`. |  |
| E1123 | La propriété d'événement requise est manquante : `{0}`. |  |
| E1124 | La propriété de relation requise est manquante : `{0}`. |  |
| E1125 | La valeur `{0}` n'est pas une option valide pour `{1}` `{2}` dans l'ensemble d'options `{3}` |  |
| E1017 | L'attribut : `{0}` n'existe pas. |  |
| E1093 | L'utilisateur : `{0}` n'a pas d'accès en écriture sur l'unité d'organisation : `{1}`. |  |
| E1094 | Il n'est pas permis de mettre à jour l'Inscription : `{0}`, Programme existant `{1}`. | La charge utile d’inscription pour inscription existante a un uid de programme différent de celui avec lequel l'inscription a été initialement faite. |
| E1110 | Il n'est pas permis de mettre à jour l'Événement : `{0}`, Programme existant `{1}`. | La charge utile d'Événement pour un Événement existant a un uid de programme différent de celui avec lequel il a été initialement créé. |
| E1111 | Nous avons un attribut généré : `{0}`, mais aucun modèle. |  |
| E1043 | La date de fin de l'événement : `{0}`, a expiré ; il n'est donc  plus possible d'apporter des modifications à cet événement. | A user without 'F_EDIT_EXPIRED' autthority cannot update an Event that has passed its expiry days as configured in its Program. |
| E1046 | L'Événement : `{0}`, doit avoir au moins une date (d'événement ou de programmation). | La propriété occuredAt (survenu à) ou selectedAt (sélectionné à) doit être présente dans la charge utile de l’événement. |
| E1047 | La date de l'événement : `{0}`, appartient à une période expirée. Un tel événement ne peut être créé. | Les propriétés occuredAt et scheduledAt de l'événement ont une valeur antérieure à la date de début du type de période (PeriodType). |
| E1300 | Généré par la règle du programme (`{0}`) - `{1}` |  |
| E1302 | Généré par la règle de programme (`{0}`) - L'élément de données `{1}` n'est pas valide : `{2}` |  |
| E1303 | Généré par la règle de programme (`{0}`) - L'élément de données obligatoire `{1}` n'est pas présent |  |
| E1304 | Généré par la règle de programme (`{0}`) - L'élément de données `{1}` n'est pas valide |  |
| E1305 | Généré par la règle de programme (`{0}`) - L'élément de données `{1}` ne fait pas partie de l'étape de programme `{2}` |  |
| E1306 | Généré par la règle de programme (`{0}`) - L'attribut obligatoire `{1}` n'est pas présent |  |
| E1307 | Généré par la règle de programme (`{0}`) - Impossible d'attribuer une valeur à l'élément de données `{1}`. La valeur fournie doit être vide ou correspondre à la valeur calculée `{2}` |  |
| E1308 | Généré par la règle de programme (`{0}`) - L'élément de données `{1}` est remplacé dans l'événement `{2}` |  |
| E1309 | Généré par la règle de programme (`{0}`) - Impossible d'attribuer une valeur à l'attribut `{1}`. La valeur fournie doit être vide ou correspondre à la valeur calculée `{2}` |  |
| E1310 | Généré par la règle de programme (`{0}`) - L'attribut `{1}` est remplacé dans l'instance d'entité suivie `{2}` |  |
| E4000 | La relation : `{0}` ne peut pas être reliée à elle-même |  |
| E4001 | L'élément de relation `{0}` n'est pas valide pour la relation `{1}`  : un élément ne peut être relié qu'à une seule entité Tracker. |  |
| E4006 | Impossible de trouver le Type de relation : `{0}`. |  |
| E4009 | Le Type de relation `{0}` n'est pas valide. |  |
| E4010 | La contrainte du type de relation `{0}` nécessite un {1} mais un {2} a été trouvé . |  |
| E4011 | Relationship: `{0}` cannot be persisted because {1} {2} referenced by this relationship is not valid. |  |
| E4012 | Impossible de trouver `{0}` : `{1}`, liés à la relation. |  |
| E4013 | La contrainte du type de relation `{0}` est manquante {1}. |  |
| E4014 | La contrainte du type de relation `{0}` nécessite une entité suivie de type `{1}` mais c'est un type `{2} ` qui a été trouvé. |  |
| E4062 | La date de début ou de fin n'est pas spécifiée avec le type de période de date ABSOLUE pour l'élément `{0}` |  |
| E4063 | Utilisateurs attribués ne peuvent pas être vides si le mode utilisateur attribué est défini sur FOURNI |  |
| E4064 | L'unité d'organisation ne peut pas être vide si le mode d'unité d'organisation est `{0}` |  |
| E4065 | L'UID de l'élément de données ne figure pas dans le filtre |  |
| E4066 | Aucun élément de données trouvé pour l'élément : `{0}` |  |
| E4067 | L'UID de l'attribut ne figure pas dans le filtre |  |
| E4068 | Aucun attribut d'entité suivie n'a été trouvé pour l'attribut : `{0}` |  |
| E9999 | N/A | Message d'erreur non défini. |

### Validation { #webapi_nti_validation }

Lors de l'importation de données à l'aide de l'importateur du Tracker, une série de validations est effectuée pour garantir la validité des données. Cette section décrit certains des différents types de validation effectués afin d'avoir une meilleure compréhension si la validation échoue pour votre importation.

#### Required properties { #required-properties }

Chaque objet Tracker possède quelques propriétés qui doivent être présentes lors de l'importation des données. Pour obtenir une liste exhaustive des propriétés requises, consultez la [section sur les objets Tracker] (#webapi_nti_tracker_objects).

Lors de la validation des propriétés requises, nous parlons généralement de références à d'autres données ou métadonnées. Dans ces cas, on note trois critères principaux :

1. La référence est présente et non nulle dans la charge utile.
2. La référence pointe vers le bon type de données et existe dans la base de données
3. L'utilisateur est autorisé à voir la référence

Si la première condition n'est pas remplie, l'importation échouera et un message indiquant une référence manquante sera généré. Cependant, si la référence indique un objet qui n'existe pas ou auquel l'utilisateur n'a pas accès, le message généré indiquera que la référence n'a pas été trouvée.

#### Formats { #formats }

Certaines propriétés des objets Tracker requièrent un format spécifique. Lors de l'importation des données, chacune de ces propriétés est validée au regard du format attendu et renvoie des erreurs en fonction de la propriété dont le format est incorrect. Voici quelques exemples de propriétés validées de cette manière :

-   UID (Ceux-ci couvrent toutes les références à d’autres données ou métadonnées dans DHIS2.)
-   Dates
-   Géométrie (Les coordonnées doivent correspondre au format spécifié par son type)

#### Accès des utilisateurs { #user-access }

All data imported will be validated based on the metadata ([Sharing](#webapi_nti_metadata_sharing)) and the organisation units ([Organisation Unit Scopes](#webapi_nti_ou_scope)) referenced in the data. You can find more information about sharing and organisation unit scopes in the following sections.

Le partage est validé en même temps que la recherche des références dans la base de données. Les métadonnées auxquelles l'utilisateur n'a pas accès seront traitées comme si elles n'existaient pas. L'importation validera toutes les métadonnées référencées dans les données.

Les unités d'organisation, quant à elles, servent un double objectif. D'une part, elles permettent de s'assurer que les données ne soient importées que pour une unité d'organisation figurant dans le "champ de saisie" de l'utilisateur. D'autre part, elles sont également utilisées pour restreindre les programmes disponibles. Cela signifie que si vous essayez d'importer des données pour une unité d'organisation qui n'a pas accès au programme que vous importez, l'importation ne sera pas valide.

Les utilisateurs disposant de l'autorité `TOUS` ne sont pas affectés par les limites des champs d'application de partage et d'unité d'organisation lorsqu'ils importent des données. Cependant, ils ne peuvent pas importer d'inscriptions dans des unités d'organisation qui n'ont pas accès au programme d'inscription.

#### Attribute and Data values { #attribute-and-data-values }

Les attributs et les valeurs de données font partie respectivement d'une entité suivie et d'un événement. Cependant, les attributs peuvent être liés à une entité suivie soit par son type (TrackedEntityType), soit par son programme (Program). Les attributs peuvent également être uniques.

La première validation effectuée lors de l'importation consiste à s'assurer que la valeur fournie pour un attribut ou un élément de données est conforme au type de valeur attendu. Par exemple, supposons que vous importiez une valeur pour un élément de données de type numérique. Dans ce cas, la valeur doit être numérique. Toute erreur liée à une non-concordance entre un type et une valeur se traduira par le même code d'erreur, mais avec un message spécifique lié au type de violation.

Les attributs et les valeurs de données obligatoires sont également vérifiés. Actuellement, la suppression des attributs obligatoires n'est pas autorisée. Dans certains cas d'utilisation, les valeurs doivent être envoyées séparément, tandis que dans d'autres, toutes les valeurs doivent être envoyées en une seule fois. Les programmes peuvent être configurés pour valider les attributs obligatoires `ON_COMPLETE` (complet ou `ON_UPDATE_AND_INSERT` pour s'adapter à ces cas d'utilisation.

Les attributs uniques sont validés au moment de l'importation. Cela signifie que tant que la valeur fournie est unique pour l'attribut et ce dans tout le système, l'importation sera acceptée. Cependant, si la valeur unique est utilisée par une autre entité suivie que celle qui est importée, l'importation échouera.

#### Configuration { #configuration }

Les dernières validations dans l'importateur sont des validations basées sur la configuration des métadonnées pertinentes par l'utilisateur. Pour plus d'informations sur chaque configuration, consultez les sections correspondantes. Trouvez ci-après quelques exemples de validations configurables :

-   Type de fonctionnalité (pour la géométrie)
-   Événements attribuables à l'utilisateur
-   Autoriser les dates futures
-   Inscrire une fois
-   Et plus.

Ces configurations apporteront des modifications supplémentaires à la manière dont la validation est effectuée lors de l'importation.

### Règles de programme { #webapi_nti_program_rules }

Les utilisateurs peuvent configurer des [Règles de programme](#webapi_program_rules), qui vont ajouter un fonctionnement conditionnel aux formulaires du Tracker. En plus d'exécuter ces règles dans les applications du Tracker, l'importateur du Tracker va également procéder à une sélection de ces règles. Puisque l'importateur exécute également ces règles, nous pouvons garantir un niveau de validation supplémentaire.

Toutes les actions de règles de programme ne sont pas prises en charge, car elles ne sont adaptées qu'à une présentation de type « frontend ». Une liste complète des actions de règles de programme prises en charge est présentée ci-dessous.

| Action de règle de programme     | Pris en charge |
| ----------------------- | :-------: |
| **DISPLAYTEXT** (afficher le texte)         |           |
| **DISPLAYKEYVALUEPAIR** (afficher la paire clé-valeur) |           |
| **HIDEFIELD** (cacher le champ)           |           |
| **HIDESECTION** (cacher la section)         |           |
| **ASSIGN** (attribuer )              |   **X**   |
| **SHOWWARNING** (afficher un avertissement)         |   **X**   |
| **SHOWERROR** (afficher l'erreur)           |   **X**   |
| **WARNINGONCOMPLETION** (avertissement à la fin) |   **X**   |
| **ERRORONCOMPLETION** (erreur à la fin)   |   **X**   |
| **CREATEEVENT** (créer un événement)         |           |
| **SETMANDATORYFIELD** (définir un champ obligatoire)   |   **X**   |
| **SENDMESSAGE** (envoyer un message)         |   **X**   |
| **SCHEDULEMESSAGE** (planifier un message)     |   **X**   |

Les règles de programme sont évaluées dans l'importateur de la même manière que dans les applications du Tracker. En résumé, les conditions suivantes sont prises en compte lors de l'application des règles de programme :

-   La règle de programme doit être liée aux données importées ; par exemple, une étape de programme ou un élément de données.
-   La condition de la règle de programme doit être évaluée comme étant vraie

Les résultats des règles de programme dépendent des actions définies dans ces règles :

-   Les actions des règles de programme peuvent aboutir à 2 résultats différents : avertissements ou erreurs.
    -   Les erreurs feront échouer la validation, tandis que les avertissements seront rapportés sous forme de message dans le récapitulatif de l'importation.
        -   Les actions SHOWWARNING (afficher l'avertissement) et WARNINGONCOMPLETION (avertissement à la fin) ne peuvent générer que des avertissements.
        -   Les actions SHOWERROR (afficher l'erreur), ERRORONCOMPLETION (erreur à la fin), et SETMANDATORYFIELD (définir un champ obligatoire) ne peuvent générer que des erreurs.
        -   L'action ASSIGN (attribuer) peut générer à la fois des avertissements et des erreurs.
            -   Lorsque l'action attribue une valeur à un attribut/élément de données vide, un avertissement est généré.
            -   Lorsque l'action attribue une valeur à un attribut/élément de données qui a déjà la même valeur à attribuer, un avertissement est généré.
            -   Lorsque l'action attribue une valeur à un attribut/élément de données qui a déjà une valeur et que la valeur à attribuer est différente, une erreur est générée à moins que le paramètre système `RULE_ENGINE_ASSIGN_OVERWRITE` soit défini sur "vrai".

Les règles de programme peuvent également entraîner des actions non voulues, telles que l'envoi et la planification de messages. Pour plus d’informations sur les actions non voulues, veuillez consulter la section suivante.

> **REMARQUE**
>
> Les règles de programme peuvent être ignorées lors de l'importation à l'aide du paramètre `skipProgramRules` (ignorer les règles de programme).

### Actions non voulues { #webapi_nti_side_effects }

Une fois qu'une importation est terminée, des tâches spécifiques peuvent être déclenchées du fait de cette importation. Ces tâches sont ce que nous appelons des « effets secondaires ». Ces tâches exécutent des opérations qui n'affectent pas l'importation elle-même.

Les effets secondaires sont des tâches qui s'exécutent séparément de l'importation, mais qui sont toujours déclenchées par une importation. Étant donné que les effets secondaires sont dissociés de l'importation, ils peuvent échouer même si l'importation réussit. De plus, les effets secondaires ne sont exécutés que lorsque l'importation réussit ; ils ne peuvent donc pas échouer dans l'autre sens.

Voici donc les effets secondaires actuellement pris en charge :

| Effets secondaires | Pris en charge | Description |
| --- | :-: | --- |
| **Notification de Tracker** | **X** | Les mises à jour peuvent déclencher des notifications. Celles qui déclenchent des notifications sont **inscription**, **mise à jour d'événement**, **achèvement d'événement ou d'inscription**. |
| **Notification de règle de programme** | **X** | Les règles de programme peuvent déclencher des notifications. Notez que ces notifications font partie des effets des règles de programme qui sont générés via le moteur de règles de DHIS2. |

> **NOTE**
>
> Certain configurations can control the execution of side effects. `skipSideEffects` flag can be set during the import to skip side effects entirely. This parameter can be useful if you import something you don't want to trigger notifications for, as an example.

### Attribuer un utilisateur à des événements { #webapi_nti_user_event_assignment }

Certains processus bénéficient du fait que des événements soient traités comme des tâches, et pour cette raison, vous pouvez attribuer un utilisateur à un événement.

Assigning a user to an event will not change the access or permissions for users but will create a link between the Event and the user. When an event has a user assigned, you can query events from the API using the `assignedUser` field as a parameter.

Lorsque vous voulez attribuer un utilisateur à un événement, fournissez simplement l'UID de cet utilisateur dans le champ `assignedUser`. Voir l'exemple suivant :

```json
{
  ...
  "events": [
    {
      "event": "ZwwuwNp6gVd",
      "programStage": "nlXNK4b7LVr",
      "orgUnit": "O6uvpzGd5pu",
      "enrollment": "MNWZ6hnuhSw",
      "assignedUser" : "M0fCOxtkURr"
    }
  ],
  ...
}
```

Dans cet exemple, l'utilisateur avec l'uid `M0fCOxtkURr` sera attribué à l'événement avec l'uid `ZwwuwNp6gVd`. Un seul utilisateur peut être attribué à un événement unique.

Pour utiliser cette fonctionnalité, l'attribution d'utilisateurs doit être activée pour l'étape de programme concernée et l'uid fourni pour l'utilisateur doit renvoyer à un utilisateur existant et valide.

## Exportation Tracker  { #webapi_nti_export }

Tracker export endpoints are a set of services that allow clients to query and retrieve objects stored using the import endpoint.

Besides differences highlighted in **[Changes in the API](#Changes-in-the-API)**, request parameters for these endpoints match older ones.

These endpoints are still being developed and are subject to change. However, the `request` and `response` interfaces will most likely not undergo significant changes.

Tracker export endpoints deal with the following Tracker objects:

-   **Tracked Entities**
-   **Événements**
-   **Inscriptions**
-   **Relations**

> **NOTE**
>
> -   All these endpoints currently support `JSON`, `CSV` is only supported by only Tracked Entities and Events.
>
> -   These endpoints adopt the new naming convention documented in **[Changes in the API](#Changes-in-the-API)**

### Common request parameters { #common-request-parameters }

Le point d'extrémité suivant prend en charge les paramètres normalisés pour la pagination.

-   **Entités suivies** `GET /api/tracker/trackedEntities`
-   **Évènements** `GET /api/tracker/events`
-   **Inscriptions** `GET /api/tracker/enrollments`
-   **Relations** `GET /api/tracker/relationships`

#### Request parameters for pagination { #request-parameters-for-pagination }

| Paramètre de requête | Type | Valeurs autorisées | Description |
| --- | --- | --- | --- |
| `page` | `Entier` | Tout entier positif | Numéro de page à renvoyer. La valeur par défaut est 1 si rien n'est fourni. |
| `taille de la page` | `Entier` | Tout entier positif | Taille de la page. La valeur par défaut est 50. |
| `totalPages` (pages totales) | `Booléen` | `vrai`, `faux` | Indique s'il faut renvoyer le nombre total de pages dans la réponse |
| `skipPaging` (ignorer la pagination) | `Booléen` | `vrai`, `faux` | Indique si la pagination doit être ignorée et si toutes les lignes doivent être renvoyées. La valeur par défaut est `faux`, ce qui signifie que par défaut toutes les requêtes sont paginées, sauf si `skipPaging=true` (c'est-à-dire si le paramètre "ignorer la pagination" est définie sur "vrai") |
| `ordre` | `Chaîne` | comma-delimited list of `OrderCriteria` in the form of `propName:sortDirection`.<br><br> Example: `createdAt:desc`<br><br>**Note:** `propName` is case sensitive, `sortDirection` is case insensitive | Sort the response based on given `OrderCriteria` |

> **Attention**
>
> Sachez que les performances sont directement liées à la quantité de données qui fait l'objet de la requête. Le renvoi des pages plus volumineuses prendra plus de temps.

#### Request parameters for Organisational Unit selection mode { #request-parameters-for-organisational-unit-selection-mode }

The available organisation unit selection modes are explained in the following table.

| Mode | Description |
| --- | --- |
| `SÉLECTIONNÉ` | Unités d'organisation définies dans la requête. |
| `SUBORDONNÉES` | Les unités d'organisation sélectionnées et leurs subordonnées directs, c'est-à-dire les unités d'organisation au niveau inférieur. |
| `DESCENDANTS` | Les unités d'organisation sélectionnées et tous leurs subordonnées, c'est-à-dire toutes les unités d'organisation de niveau inférieur dans la hiérarchie. |
| `ACCESSIBLE` | Il s'agit des unités d'organisation de visualisation de données associées à l'utilisateur actuel et toutes leurs subordonnées, c'est-à-dire toutes les unités d'organisation qui leur sont inférieures dans la hiérarchie. Les unités d'organisation de saisie de données associées à l'utilisateur actuel seront utilisées si celles dédiées à la visualisation ne sont pas définies. |
| `SAISIE` | Il s'agit des unités d'organisation de saisie de données associées à l'utilisateur actuel et toutes leurs subordonnées, c'est-à-dire toutes les unités d'organisation qui leur sont inférieures dans la hiérarchie. |
| `TOUS` | Il s'agit de toutes les unités d'organisation du système. L'utilisateur doit disposer de l'autorité `TOUS` pour pouvoir l'utiliser. |

#### Paramètre de requête pour filtrer les réponses { #webapi_nti_field_filter }

All export endpoints accept a `fields` parameter which controls which fields will be returned in the JSON response. `fields` parameter accepts a comma separated list of field names or patterns. A few possible `fields` filters are shown below. Refer to [Metadata field filter](#webapi_metadata_field_filter) for a more complete guide on how to use `fields`.

##### Examples { #examples }

| Exemple de paramètre | Signification |
| :-- | :-- |
| `champs=*` | renvoie tous les champs |
| `fields=createdAt,uid` (champs=créés à, uid) | renvoie uniquement les champs `createdAt` et `uid` |
| `fields=inscriptions[*,!uid]` (champs=inscriptions, uid) | renvoie tous les champs des `inscriptions` sauf les `uid` |
| `fields=enrollments[uid]` | renvoie uniquement l'`uid` du champ `inscriptions` |
| `fields=enrollments[uid,enrolledAt]` | renvoie uniquement l'`uid` des champs `inscriptions` et `enrolledAt` (inscrit à) |

### Tracked Entities (`GET /api/tracker/trackedEntities`) { #tracked-entities-get-apitrackertrackedentities }

Deux points d'extrémité sont dédiés aux entités suivies :

-   `GET /api/tracker/trackedEntities`
    -   récupère les entités suivies correspondant aux critères donnés
-   `GET /api/tracker/trackedEntities/{id}`
    -   récupère une entité suivie en fonction de l'identifiant fourni

#### Tracked Entities Collection endpoint `GET /api/tracker/trackedEntities` { #tracked-entities-collection-endpoint-get-apitrackertrackedentities }

Le but de ce point d'extrémité est de récupérer les entités suivies correspondant aux critères fournis par le client.

Le point d'extrémité renvoie une liste d'entités suivies qui correspondent aux paramètres de la requête.

##### Request syntax { #request-syntax }

| Paramètre de requête | Type | Valeurs autorisées | Description |
| --- | --- | --- | --- |
| `requête` | `Chaîne` | `{operator}:{filter-value}` | Crée un filtre sur les attributs d'entité suivie. Seule la valeur du filtre est obligatoire. L'opérateur `EQ` est utilisé si l'`opérateur` n'est pas spécifié. |
| `attribut` | `Chaîne` | Valeurs des `UID` d'attribut séparées par des virgules  | Pour chaque entité suivie dans la réponse, renvoie uniquement les attributs spécifiés |
| `filtre` | `Chaîne` | Valeurs des filtres d'attribut séparées par des virgules  | Narrows response to TEIs matching given filters. A filter is a colon separated property or attribute UID with optional operator and value pairs. Example: `filter=H9IlTX2X6SL:sw:A` with operator starts with `sw` followed by a value. Special characters like `+` need to be percent-encoded so `%2B` instead of `+`. Multiple operator/value pairs for the same property/attribute like `filter=AuPLng5hLbE:gt:438901703:lt:448901704` are allowed. Repeating the same attribute UID is not allowed. User needs access to the attribute to filter on it. |
| `orgUnit` (unité d'organisation) | `Chaîne` | semicolon-delimited list of organisational unit `UID` | Renvoie uniquement les instances d'entités suivies appartenant aux unités d'organisation fournies |
| Pour plus d'informations sur le `ouMode` (mode d'unité d'organisation) voir [ouModes](#Request-parameters-for-Organisational-Unit-selection-mode) | `Chaîne` | `SELECTED`&#124;`CHILDREN`&#124;`DESCENDANTS`&#124;`ACCESSIBLE`&#124;`CAPTURE`&#124;`ALL` | Le mode de sélection des unités d'organisation peut l'être. La valeur par défaut est `SÉLECTIONNÉ`, qui fait uniquement référence aux unités d'organisation sélectionnées. |
| `programme` | `Chaîne` | `UID` de programme | un `UID` de programme dans lequel les instances présentes dans la réponse doivent être inscrites |
| `statut du programme` | `Chaîne` | `ACTIVE`&#124;`COMPLETED`&#124;`CANCELLED` | Le statut du programme de l’instance d’entité suivie dans le programme donné |
| `programStage` (étape de programme) | `Chaîne` | `UID` | un `UID` d'étape de programme pour lequel les instances présentes dans la réponse doivent avoir des événements |
| `followUp` (suivi) | `Booléen` | `vrai`, `faux` | Indique si l'instance d'entité suivie est marquée pour le suivi du programme spécifié. |
| `updatedAfter` (mis à jour après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de début de la dernière mise à jour |
| `updatedBefore` (mis à jour avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de fin de la dernière mise à jour |
| `updatedWithin` | `Durée` | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601#Durations) | Renvoie les TEI qui ne dépassent pas la durée spécifiée |
| `enrollmentEnrolledAfter` (Inscription après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de début de l’inscription au programme donné |
| `enrollmentEnrolledBefore` (Inscription avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de fin de l’inscription au programme donné |
| `enrollmentOccurredAfter` (Inscription survenue après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de début de l'incident dans le programme donné |
| `enrollmentOccurredBefore` (inscription survenue avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de fin de l'incident dans le programme donné |
| `TrackedEntityType` (Type d'entité suivie) | `Chaîne` | UID du type d'entité suivi | Renvoie uniquement les instances d'entité suivies d'un type donné |
| `trackedEntity` (entité suivie) | `Chaîne` | semicolon-delimited list of tracked entity instance `UID` | Filtrez le résultat de manière à obtenir un ensemble limité d'entités suivies qui utilisent les uids explicites des instances d'entités suivies. Faites-le en utilisant le paramètre `trackedEntity=id1;id2`. Ce paramètre créera, au minimum, la limite externe des résultats, en constituant la liste de toutes les entités suivies à l'aide des uids fournis. Si d'autres paramètres/filtres de ce tableau sont utilisés, ils limiteront davantage les résultats à partir de la limite externe explicite. |
| `assignedUserMode` (mode utilisateur attribué) | `Chaîne` | `CURRENT`&#124;`PROVIDED`&#124;`NONE`&#124;`ANY` | Restreint le résultat aux entités suivies avec des événements attribués en fonction du mode de sélection de l'utilisateur attribué. Voir le tableau ci-dessous "Modes utilisateur attribué" pour les explications. |
| `assignedUser` (utilisateur attribué) | `Chaîne` | Semicolon-delimited list of user UIDs to filter based on events assigned to the users. | Il est possible de filtrer le résultat pour obtenir un ensemble limité d'entités suivies avec des événements attribués aux UID donnés, à l'aide du paramètre `assignedUser=id1;id2`. Ce paramètre ne sera pris en compte que si le "mode utilisateur assigné" est `FOURNI` ou `nul`. L'API va générer une erreur si, par exemple, `assignedUserMode=CURRENT` et `assignedUser=someId` |
| `eventStatus` (statut d'événement) | `Chaîne` | `ACTIVE`&#124;`COMPLETED`&#124;`VISITED`&#124;`SCHEDULE`&#124;`OVERDUE`&#124;`SKIPPED` | Il s'agit du statut de tous les événements présents dans le programme spécifié |
| `eventOccurredAfter` (événement survenu après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de début de l'événement pour le programme donné |
| `eventOccurredBefore` (événement survenu avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de fin de l'événement pour le programme donné |
| `skipMeta` | `Booléen` | `vrai`, `faux` | Indique s’il convient de ne pas inclure les métadonnées dans la réponse. |
| `includeDeleted` (inclure les éléments supprimés) | `Booléen` | `vrai`, `faux` | Indique s’il faut inclure les éléments supprimés mais pas définitivement (soft delete) |
| `includeAllAttributes` (inclure tous les attributs) | `Booléen` | `vrai`, `faux` | Indique s'il faut inclure tous les attributs TEI |
| `attachment` | `Chaîne` |  | Il s'agit du nom du fichier en cas d'exportation sous forme de fichier |
| `potentialDuplicate` (doublon potentiel) | `Booléen` | `vrai`, `faux` | Il est possible de filtrer le résultat en supposant qu'une TEI soit un doublon potentiel. true: renvoie les TEI marqués comme doublons potentiels. false: renvoie les TEI NON marqués comme doublons potentiels. En cas d'omission, nous ne vérifions pas si une TEI est un doublon potentiel ou pas. |

Les modes 'utilisateur attribué' disponibles sont expliqués dans le tableau suivant.

Tableau : Modes d'utilisateur assigné

| Mode | Description |
| --- | --- |
| ACTUEL | Inclut les événements attribués à l’utilisateur actuellement connecté. |
| FOURNI | Inclut les événements attribués à l’utilisateur fourni dans la requête. |
| AUCUNE | Inclut uniquement les événements non attribués. |
| TOUT | Inclut tous les événements attribués, peu importe à qui ils sont attribués. |

The query is case insensitive. The following rules apply to the query parameters.

-   At least one organisation unit must be specified using the `orgUnit` parameter (one or many), or `ouMode=ALL` must be specified.

-   Only one of the `program` and `trackedEntity` parameters can be specified (zero or one).

-   If `programStatus` is specified, then `program` must also be specified.

-   Si `followUp` est spécifié, alors `program` doit également être spécifié.

-   If `enrollmentEnrolledAfter` or `enrollmentEnrolledBefore` is specified then `program` must also be specified.

-   Les éléments du filtre ne peuvent être spécifiés qu'une seule fois.

##### Example requests { #example-requests }

A query for all instances associated with a specific organisation unit can look like this:

    GET /api/tracker/trackedEntities?orgUnit=DiszpKrYNg8

To query for instances using one attribute with a filter and one attribute without a filter, with one organisation unit using the descendant organisation unit query mode:

    GET /api/tracker/trackedEntities?filter=zHXD5Ve1Efw:EQ:A
        &attribure=AMpUYgxuCaE&orgUnit=DiszpKrYNg8;yMCshbaVExv

A query for instances where attributes are included in the response and one attribute is used as a filter:

    GET /api/tracker/trackedEntities?filter=zHXD5Ve1Efw:EQ:A
        &filter=AMpUYgxuCaE:LIKE:Road
        &orgUnit=DiszpKrYNg8

A query where multiple operand and filters are specified for a filter item:

    GET /api/tracker/trackedEntities?orgUnit=DiszpKrYNg8
        &program=ur1Edk5Oe2n
        &filter=lw1SqmMlnfh:GT:150
        &filter=lw1SqmMlnfh:LT:190

To query on an attribute using multiple values in an _IN_ filter:

    GET /api/tracker/trackedEntities?orgUnit=DiszpKrYNg8
        &filter=dv3nChNSIxy:IN:Scott;Jimmy;Santiago

To constrain the response to instances which are part of a specific program you can include a program query parameter:

    GET /api/tracker/trackedEntities?filter=zHXD5Ve1Efw:EQ:A
        &orgUnit=O6uvpzGd5pu&ouMode=DESCENDANTS
        &program=ur1Edk5Oe2n

Pour spécifier les dates d'inscription au programme dans la requête :

    GET /API/tracker/trackedEntities?
        &orgUnit=O6uvpzGd5pu&program=ur1Edk5Oe2n
        &enrollmentEnrolledAfter=2013-01-01
        &enrollmentEnrolledBefore=2013-09-01

To constrain the response to instances of a specific tracked entity you can include a tracked entity query parameter:

    GET /api/tracker/trackedEntities?filter=zHXD5Ve1Efw:EQ:A
        &orgUnit=O6uvpzGd5pu
        &ouMode=DESCENDANTS
        &trackedEntity=cyl5vuJ5ETQ

By default the instances are returned in pages of size 50, to change this you can use the page and pageSize query parameters:

    GET /api/tracker/trackedEntities?filter=zHXD5Ve1Efw:EQ:A
        &orgUnit=O6uvpzGd5pu
        &ouMode=DESCENDANTS
        &page=2&pageSize=3

Vous pouvez utiliser une gamme d'opérateurs pour le filtrage :

| Opérateur | Description                                          |
| -------- | ---------------------------------------------------- |
| `EQ`     | Egale à                                             |
| `GT`     | Supérieure à                                         |
| `GE`     | Supérieure ou égal à                             |
| `LT`     | Inférieur à                                            |
| `LE`     | inférieur ou égal à                                |
| `NE`     | Pas égal à                                         |
| `LIKE`   | Like (free text match)                               |
| `IN`     | Égal à l'une des multiples valeurs séparées par ";" |

##### Response format { #response-format }

La réponse `JSON` peut ressembler à ceci :

Les réponses peuvent être filtrées en fonction des champs recherchés ; voir [Paramètre de requête pour filtrer les réponses](#webapi_nti_field_filter)

```json
{
  "instances": [
    {
      "trackedEntity": "IzHblRD2sDH",
      "trackedEntityType": "nEenWmSyUEp",
      "createdAt": "2014-03-26T15:40:36.669",
      "createdAtClient": "2014-03-26T15:40:36.669",
      "updatedAt": "2014-03-28T12:28:17.544",
      "orgUnit": "g8upMTyEZGZ",
      "inactive": false,
      "deleted": false,
      "relationships": [],
      "attributes": [
        {
          "attribute": "VqEFza8wbwA",
          "code": "MMD_PER_ADR1",
          "displayName": "Address",
          "createdAt": "2016-01-12T00:00:00.000",
          "updatedAt": "2016-01-12T00:00:00.000",
          "valueType": "TEXT",
          "value": "1061 Marconi St"
        },
        {
          "attribute": "RG7uGl4w5Jq",
          "code": "Longitude",
          "displayName": "Longitude",
          "createdAt": "2016-01-12T00:00:00.000",
          "updatedAt": "2016-01-12T00:00:00.000",
          "valueType": "TEXT",
          "value": "27.866613"
        },
        ...,
        ...,
      ],
      "enrollments": [],
      "programOwners": []
    }
  ],
  "page": 1,
  "total": 39,
  "pageSize": 1
}
```

#### Point d'extrémité d'objet unique des entités suivies `GET /api/tracker/trackedEntities/{uid}`

Le but de ce point d'extrémité est de récupérer une entité suivie en se basant sur son UID.

##### Request syntax { #request-syntax }

`GET /api/tracker/trackedEntities/{uid}?program={programUid}&fields={fields}`

| Paramètre de requête | Type | Valeurs autorisées | Description |
| --- | --- | --- | --- |
| `uid` | `Chaîne` | `uid` | Renvoie l'instance d'entité suivie disposant de l'`uid` spécifié |
| `programme` | `Chaîne` | `uid` | Inclut les attributs du programme dans la réponse (seuls ceux auxquels l'utilisateur a accès) |
| `champs` | `Chaîne` | Tout filtre de champ valide (par défaut `*,!relationships,!enrollments,!events,!programOwners`) | Inclut les sous-objets spécifiés dans la réponse |

##### Example requests { #example-requests }

Une requête pour une instance d'entité suivie :

    GET /api/tracker/trackedEntities/IzHblRD2sDH?program=ur1Edk5Oe2n&fields=*

##### Response format { #response-format }

Ce point d'extrémité permet de renvoyer des sous-objets lorsque le paramètre de requête `fields` (champs) est transmis après que le format json soit demandé. Dans le cas du format csv, le paramètre de requête `fields` n'a pas d'effet et la réponse contiendra toujours les mêmes champs, qui sont :

-   trackedEntity (Identifiant)
-   trackedEntityType (identifiant)
-   createdAt (Date et heure)
-   createdAtClient (Date et heure)
-   updatedAt (Date et heure)
-   updatedAtClient (Date et heure)
-   orgUnit (Identifiant)
-   inactif (booléen)
-   supprimé (booléen)
-   potentialDuplicate (booléen)
-   géométrie (WKT, https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry)
-   stockéBy (Chaîne)
-   createdBy (Nom d'utilisateur de l'utilisateur)
-   updatedBy (Nom d'utilisateur de l'utilisateur)
-   attributs (tout attribut valide répertorié dans une autre colonne)

Exemple de réponse json :

```json
{
    "trackedEntity": "IzHblRD2sDH",
    "trackedEntityType": "nEenWmSyUEp",
    "createdAt": "2014-03-26T15:40:36.669",
    "updatedAt": "2014-03-28T12:28:17.544",
    "orgUnit": "g8upMTyEZGZ",
    "inactive": false,
    "deleted": false,
    "relationships": [],
    "attributes": [
        {
            "attribute": "w75KJ2mc4zz",
            "code": "MMD_PER_NAM",
            "displayName": "First name",
            "createdAt": "2016-01-12T09:10:26.986",
            "updatedAt": "2016-01-12T09:10:35.884",
            "valueType": "TEXT",
            "value": "Wegahta"
        },
        {
            "attribute": "zDhUuAYrxNC",
            "displayName": "Last name",
            "createdAt": "2016-01-12T09:10:26.986",
            "updatedAt": "2016-01-12T09:10:35.884",
            "valueType": "TEXT",
            "value": "Goytiom"
        }
    ],
    "enrollments": [
        {
            "enrollment": "uT5ZysTES7j",
            "createdAt": "2017-03-28T12:28:17.539",
            "createdAtClient": "2016-03-28T12:28:17.539",
            "updatedAt": "2017-03-28T12:28:17.544",
            "trackedEntity": "IzHblRD2sDH",
            "trackedEntityType": "nEenWmSyUEp",
            "program": "ur1Edk5Oe2n",
            "status": "ACTIVE",
            "orgUnit": "g8upMTyEZGZ",
            "orgUnitName": "Njandama MCHP",
            "enrolledAt": "2020-11-10T12:28:17.532",
            "occurredAt": "2020-10-12T12:28:17.532",
            "followUp": false,
            "deleted": false,
            "events": [
                {
                    "event": "ixDYEGrNQeH",
                    "status": "ACTIVE",
                    "program": "ur1Edk5Oe2n",
                    "programStage": "ZkbAXlQUYJG",
                    "enrollment": "uT5ZysTES7j",
                    "enrollmentStatus": "ACTIVE",
                    "trackedEntity": "IzHblRD2sDH",
                    "relationships": [],
                    "scheduledAt": "2019-10-12T12:28:17.532",
                    "followup": false,
                    "deleted": false,
                    "createdAt": "2017-03-28T12:28:17.542",
                    "createdAtClient": "2016-03-28T12:28:17.542",
                    "updatedAt": "2017-03-28T12:28:17.542",
                    "attributeOptionCombo": "HllvX50cXC0",
                    "attributeCategoryOptions": "xYerKDKCefk",
                    "dataValues": [],
                    "notes": []
                }
            ],
            "relationships": [],
            "attributes": [],
            "notes": []
        }
    ],
    "programOwners": [
        {
            "orgUnit": "g8upMTyEZGZ",
            "trackedEntity": "IzHblRD2sDH",
            "program": "ur1Edk5Oe2n"
        }
    ]
}
```

### Events (`GET /api/tracker/events`) { #events-get-apitrackerevents }

Deux points d'extrémité sont dédiés aux événements :

-   `GET /api/tracker/events`
    -   récupère les événements correspondant aux critères donnés
-   `GET /api/tracker/events/{id}`
    -   récupère un événement en fonction de l'identifiant fourni

#### Events Collection endpoint `GET /api/tracker/events` { #events-collection-endpoint-get-apitrackerevents }

Renvoie une liste d'événements en fonction des filtres fournis.

| Paramètre de requête | Type | Valeurs autorisées | Description |
| --- | --- | --- | --- |
| `programme` | `Chaîne` | `uid` | Identifiant du programme |
| `programStage` (étape de programme) | `Chaîne` | `uid` | Identifiant de l'étape de programme |
| `statut du programme` | `énumération` | `ACTIVE`&#124;`COMPLETED`&#124;`CANCELLED` | Statut de l'événement dans le programme |
| `filtre` | `Chaîne` | Valeurs des filtres d'éléments de données, séparées par des virgules  | Narrows response to events matching given filters. A filter is a colon separated property or data element UID with optional operator and value pairs. Example: `filter=fazCI2ygYkq:eq:PASSIVE` with operator starts with `eq` followed by a value. Multiple operator/value pairs for the same property/data element like `filter=qrur9Dvnyt5:gt:70:lt:80` are allowed. Repeating the same data element UID is not allowed. User needs access to the data element to filter on it. |
| `filterAttributes` (attributs de filtres) | `Chaîne` | Valeurs des filtres d'attribut séparées par des virgules  | Narrows response to TEIs matching given filters. A filter is a colon separated property or attribute UID with optional operator and value pairs. Example: `filter=H9IlTX2X6SL:sw:A` with operator starts with `sw` followed by a value. Special characters like `+` need to be percent-encoded so `%2B` instead of `+`. Multiple operator/value pairs for the same property/attribute like `filter=AuPLng5hLbE:gt:438901703:lt:448901704` are allowed. Repeating the same attribute UID is not allowed. User needs access to the attribute to filter on it. |
| `followUp` (suivi) | `booléen` | `vrai`, `faux` | Détermine si l'événement est pris en compte pour un suivi dans le programme. La valeur par défaut est `vrai` |
| `trackedEntityInstance` | `Chaîne` | `uid` | Identifiant de l'instance d'entité suivie |
| `orgUnit` (unité d'organisation) | `Chaîne` | `uid` | Identifiant de l'unité d'organisation |
| Pour plus d'informations sur le `ouMode` (mode d'unité d'organisation) voir [ouModes](#Request-parameters-for-Organisational-Unit-selection-mode) | `Chaîne` | `SELECTED`&#124;`CHILDREN`&#124;`DESCENDANTS` | Mode de sélection de l'unité d'organisation |
| `statut` | `Chaîne` | `ACTIVE`&#124;`COMPLETED`&#124;`VISITED`&#124;`SCHEDULE`&#124;`OVERDUE`&#124;`SKIPPED` | Statut de l'événement |
| `occurredAfter` (survenu après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Filtre pour les événements survenus après cette date. |
| `occurredBefore` (survenu avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Filtre pour les événements survenus jusqu'à cette date. |
| `scheduledAfter` (programmé après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Filtre pour les événements programmés après cette date. |
| `scheduledBefore` (programmé av | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Filtre pour les événements programmés avant cette date. |
| `updatedAfter` (mis à jour après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Filtre pour les événements qui ont été mis à jour après cette date. Ne peut pas être utilisé avec `updatedWithin`. |
| `updatedBefore` (mis à jour avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Filtre pour les événements qui ont été mis à jour jusqu'à cette date. Ne peut pas être utilisé avec `updatedWithin`. |
| `updatedWithin` | `Durée` | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601#Durations) | Incluez uniquement les éléments mis à jour pendant la durée indiquée.<br><br> Le format est [ISO-8601#Duration](https : //en.wikipedia.org/wiki/ISO_8601#Durations) |
| `enrollmentEnrolledAfter` (Inscription après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de début de l’inscription au programme donné |
| `enrollmentEnrolledBefore` (Inscription avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de fin de l’inscription au programme donné |
| `enrollmentOccurredAfter` (Inscription survenue après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de début de l'incident dans le programme donné |
| `enrollmentOccurredBefore` (inscription survenue avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Date de fin de l'incident dans le programme donné |
| `skipMeta` | `Booléen` | `vrai`, `faux` | Exclut la partie métadonnées de la réponse (améliore les performances) |
| `dataElementIdScheme` (Schéma d'identification de l'élément de données) | `Chaîne` | `UID`&#124;`CODE`&#124;`ATTRIBUTE:{ID}` | Schéma d’identification de l'élément de données à utiliser pour l’exportation. |
| categoryOptionComboIdScheme (`Schéma d'identification de la combinaison d'options de catégorie`) | `Chaîne` | `UID`&#124;`CODE`&#124;`ATTRIBUTE:{ID}` | Schéma d'identification de la combinaison d'options de catégorie à utiliser pour l'exportation |
| `orgUnitIdScheme` (Schéma d'identification de l'unité d'organisation) | `Chaîne` | `UID`&#124;`CODE`&#124;`ATTRIBUTE:{ID}` | Schéma d'ID de l'unité d'organisation à utiliser pour l'exportation |
| `programIdScheme` (Schéma d'identification du programme) | `Chaîne` | `UID`&#124;`CODE`&#124;`ATTRIBUTE:{ID}` | Schéma d’identification de programme à utiliser pour l’exportation. |
| `programStageIdScheme` (Schéma d'identification d'étape de programme) | `Chaîne` | `UID`&#124;`CODE`&#124;`ATTRIBUTE:{ID}` | Schéma d’identification d'étape de programme à utiliser pour l’exportation. |
| `idScheme` (Schéma d'identification) | `chaîne` | `UID`&#124;`CODE`&#124;`ATTRIBUTE:{ID}` | Permet de définir le schéma d'identification  à la fois pour l'élément de données, la combinaison d'options de catégorie, l'unité d'organisation, le programme et l'étape de programme. |
| `ordre` | `Chaîne` | comma-delimited list of property name, attribute or data element UID and sort direction pairs in format `propName:sortDirection`. | Sort the response based on given order values.<br><br>Example: `createdAt:desc` or `SzVk2KvkSSd:asc`<br><br>**Note:** `propName` is case sensitive, `sortDirection` is case insensitive. Supported are `storedBy, attributeCategoryOptions, dueDate, assignedUserUsername, createdAtClient, program, lastUpdated, event, assignedUser, programStage, programType, occurredAt, created, createdAt, orgUnit, completedDate, enrollment, trackedEntityInstance, followup, deleted, enrollmentStatus, attributeOptionCombo, assignedUserDisplayName, completedBy, orgUnitName, eventDate, lastUpdatedAtClient, status, enrolledAt`. |
| `événement` | `Chaîne` | liste d'`uid` délimités par des virgules | Filtre le résultat pour obtenir un ensemble limité d’identifiants en utilisant event=id1;id2. |
| `skipEventId` (ignorer l'identifiant de l'élément) | `Booléen` |  | Ignore les identifiants d'événement dans la réponse |
| `attributeCc` (voir la note) | `Chaîne` | Identifiant de la combinaison de catégories d'attribut (doit être combiné aux options de catégorie d'attribut (attributCos)) |
| `attributeCos` (voir la note) | `Chaîne` | Identifiants d'options de catégorie d'attribut, séparés par ";"(doit être combiné à la combinaison de catégories d'attribut (attributeCc)) |
| `includeDeleted` (inclure les éléments supprimés) | `Booléen` |  | S'il est défini sur "vrai", les événements supprimés mais pas définitivement seront inclus dans le résultat de votre requête. |
| `assignedUserMode` (mode utilisateur attribué) | `Chaîne` | `CURRENT`&#124;`PROVIDED`&#124;`NONE`&#124;`ANY` | Mode de sélection de l'utilisateur assigné |
| `assignedUser` (utilisateur attribué) | `Chaîne` | liste d'`uid` délimités par des virgules | Il est possible de filtrer le résultat pour obtenir un ensemble limité d'événements qui sont attribués aux UID donnés, à l'aide du paramètre `assignedUser=id1;id2`. <br><br>Ce paramètre ne sera pris en compte que si le "mode d'utilisateur assigné" est `FOURNI` ou `nul`. <br><br>L'API va générer une erreur si, par exemple, `assignedUserMode=CURRENT` et `assignedUser=someId` |

> **Note**
>
> If the query contains neither `attributeCC` nor `attributeCos`, the server returns events for all attribute option combos where the user has read access.

##### Example requests { #example-requests }

La requête pour tous les événements ayant des subordonnées d'une unité d'organisation particulière :

    GET /api/tracker/events?orgUnit=YuQRtpLP10I&ouMode=CHILDREN

The query for all events with all descendants of a particular organisation unit, implying all organisation units in the sub-hierarchy:

    GET /api/tracker/events?orgUnit=O6uvpzGd5pu&ouMode=DESCENDANTS

La requête pour tous les événements disposant d'un programme et d'une unité d'organisation :

    GET /api/tracker/events?orgUnit=DiszpKrYNg8&program=eBAyeGv0exc

Query for all events with a certain program and organisation unit, sorting by due date ascending:

    GET /api/tracker/events?orgUnit=DiszpKrYNg8&program=eBAyeGv0exc&order=dueDate

Query for the 10 events with the newest event date in a certain program and organisation unit - by paging and ordering by due date descending:

    GET /api/tracker/events?orgUnit=DiszpKrYNg8&program=eBAyeGv0exc
      &order=eventDate:desc&pageSize=10&page=1

Query for all events with a certain program and organisation unit for a specific tracked entity instance:

    GET /api/tracker/events?orgUnit=DiszpKrYNg8
      &program=eBAyeGv0exc&trackedEntityInstance=gfVxE3ALA9m

Query for all events with a certain program and organisation unit older or equal to 2014-02-03:

    GET /api/tracker/events?orgUnit=DiszpKrYNg8&program=eBAyeGv0exc&endDate=2014-02-03

Query for all events with a certain program stage, organisation unit and tracked entity instance in the year 2014:

    GET /api/tracker/events?orgUnit=DiszpKrYNg8&program=eBAyeGv0exc
      &trackedEntityInstance=gfVxE3ALA9m&occurredAfter=2014-01-01&occurredBefore=2014-12-31

Retrieve events with specified Organisation unit and Program, and use `Attribute:Gq0oWTf2DtN` as identifier scheme

    GET /api/tracker/events?orgUnit=DiszpKrYNg8&program=lxAQ7Zs9VYR&idScheme=Attribute:Gq0oWTf2DtN

Retrieve events with specified Organisation unit and Program, and use UID as identifier scheme for organisation units, Code as identifier scheme for Program stages, and _Attribute:Gq0oWTf2DtN_ as the identifier scheme for the rest of the metadata with assigned attributes.

    GET /api/tracker/events?orgUnit=DiszpKrYNg8&program=lxAQ7Zs9VYR&idScheme=Attribute:Gq0oWTf2DtN
      &orgUnitIdScheme=UID&programStageIdScheme=Code

##### Response format { #response-format }

La réponse `JSON` peut ressembler à ceci :

```json
{
    "instances": [
        {
            "event": "rgWr86qs0sI",
            "status": "ACTIVE",
            "program": "kla3mAPgvCH",
            "programStage": "aNLq9ZYoy9W",
            "orgUnit": "DiszpKrYNg8",
            "orgUnitName": "Ngelehun CHC",
            "relationships": [],
            "occurredAt": "2021-10-12T00:00:00.000",
            "followup": false,
            "deleted": false,
            "createdAt": "2018-10-20T12:09:19.492",
            "updatedAt": "2018-10-20T12:09:19.492",
            "attributeOptionCombo": "amw2rQP6r6M",
            "attributeCategoryOptions": "RkbOhHwiOgW",
            "dataValues": [
                {
                    "createdAt": "2015-10-20T12:09:19.640",
                    "updatedAt": "2015-10-20T12:09:19.640",
                    "storedBy": "system",
                    "providedElsewhere": false,
                    "dataElement": "HyJL2Lt37jN",
                    "value": "12"
                },
              ...
            ],
            "notes": []
        }
    ],
    "page": 1,
    "pageSize": 1
}
```

La réponse `CSV` peut ressembler à ceci :

```
|event|status|program|programStage|enrollment|orgUnit|occurredAt|scheduledAt|dataElement|value|storedBy|providedElsewhere
|---|---|---|---|---|---|---|---|---|---|---|---|
|V1CerIi3sdL|COMPLETED|IpHINAT79UW|A03MvHHogjR|CCBLMntFuzb|DiszpKrYNg8|2020-02-26T23:00:00Z|2020-02-27T23:00:00Z|a3kGcGDCuk6|11|admin|false
|V1CerIi3sdL|COMPLETED|IpHINAT79UW|A03MvHHogjR|CCBLMntFuzb|DiszpKrYNg8|2020-02-26T23:00:00Z|2020-02-27T23:00:00Z|mB2QHw1tU96|[-11.566044,9.477801]|admin|false
```

#### Point d'extrémité d'objet unique d'événements `GET /api/tracker/events/{uid}`

Le but de ce point d'extrémité est de récupérer un événement en se basant sur son UID.

##### Request syntax { #request-syntax }

`GET /api/tracker/events/{uid}?fields={fields}`

| Paramètre de requête | Type | Valeurs autorisées | Description |
| --- | --- | --- | --- |
| `uid` | `Chaîne` | `uid` | Renvoie l'événement disposant de l'`uid` spécifié |
| `champs` | `Chaîne` | Tout filtre de champ valide (par défaut `*,!relationships`) | Inclut les sous-objets spécifiés dans la réponse |

##### Example requests { #example-requests }

Une requête pour un événement :

    GET /api/tracker/events/rgWr86qs0sI

##### Response format { #response-format }

```json
{
    "event": "rgWr86qs0sI",
    "status": "ACTIVE",
    "program": "kla3mAPgvCH",
    "programStage": "aNLq9ZYoy9W",
    "enrollment": "Lo3SHzCnMSm",
    "enrollmentStatus": "ACTIVE",
    "orgUnit": "DiszpKrYNg8",
    "orgUnitName": "Ngelehun CHC",
    "relationships": [],
    "occurredAt": "2021-10-12T00:00:00.000",
    "followup": false,
    "deleted": false,
    "createdAt": "2018-10-20T12:09:19.492",
    "createdAtClient": "2017-10-20T12:09:19.492",
    "updatedAt": "2018-10-20T12:09:19.492",
    "attributeOptionCombo": "amw2rQP6r6M",
    "attributeCategoryOptions": "RkbOhHwiOgW",
    "dataValues": [
        {
            "createdAt": "2015-10-20T12:09:19.640",
            "updatedAt": "2015-10-20T12:09:19.640",
            "storedBy": "system",
            "providedElsewhere": false,
            "dataElement": "HyJL2Lt37jN",
            "value": "12"
        },
        {
            "createdAt": "2015-10-20T12:09:19.514",
            "updatedAt": "2015-10-20T12:09:19.514",
            "storedBy": "system",
            "providedElsewhere": false,
            "dataElement": "b6dOUjAarHD",
            "value": "213"
        },
        {
            "createdAt": "2015-10-20T12:09:19.626",
            "updatedAt": "2015-10-20T12:09:19.626",
            "storedBy": "system",
            "providedElsewhere": false,
            "dataElement": "UwCXONyUtGs",
            "value": "3"
        },
        {
            "createdAt": "2015-10-20T12:09:19.542",
            "updatedAt": "2015-10-20T12:09:19.542",
            "storedBy": "system",
            "providedElsewhere": false,
            "dataElement": "fqnXmRYo5Cz",
            "value": "123"
        },
        {
            "createdAt": "2015-10-20T12:09:19.614",
            "updatedAt": "2015-10-20T12:09:19.614",
            "storedBy": "system",
            "providedElsewhere": false,
            "dataElement": "Qz3kfeKgLgL",
            "value": "23"
        },
        {
            "createdAt": "2015-10-20T12:09:19.528",
            "updatedAt": "2015-10-20T12:09:19.528",
            "storedBy": "system",
            "providedElsewhere": false,
            "dataElement": "W7aC8jLASW8",
            "value": "12"
        },
        {
            "createdAt": "2015-10-20T12:09:19.599",
            "updatedAt": "2015-10-20T12:09:19.599",
            "storedBy": "system",
            "providedElsewhere": false,
            "dataElement": "HrJmqlBqTFG",
            "value": "3"
        }
    ],
    "notes": []
}
```

### Enrollments (`GET /api/tracker/enrollments`) { #enrollments-get-apitrackerenrollments }

Deux points d'extrémité sont dédiés aux inscriptions :

-   `GET /api/tracker/enrollments`
    -   récupère les inscriptions correspondant aux critères donnés
-   `GET /api/tracker/enrollments/{id}`
    -   récupère une inscription en fonction de l'identifiant fourni

#### Enrollment Collection endpoint `GET /api/tracker/enrollments` { #enrollment-collection-endpoint-get-apitrackerenrollments }

Renvoie une liste d'événements en fonction des filtres.

| Paramètre de requête | Type | Valeurs autorisées | Description |
| --- | --- | --- | --- |
| `orgUnit` (unité d'organisation) | `Chaîne` | `uid` | Identifiant de l'unité d'organisation |
| Pour plus d'informations sur le `ouMode` (mode d'unité d'organisation) voir [ouModes](#Request-parameters-for-Organisational-Unit-selection-mode) | `Chaîne` | `SELECTED`&#124;`CHILDREN`&#124;`DESCENDANTS`&#124;`ACCESSIBLE`&#124;`CAPTURE`&#124;`ALL | Mode de sélection de l'unité d'organisation |
| `programme` | `Chaîne` | `uid` | Identifiant du programme |
| `statut du programme` | `énumération` | `ACTIVE`&#124;`COMPLETED`&#124;`CANCELLED` | Statut du programme |
| `followUp` (suivi) | `booléen` | `vrai`, `faux` | Follow up status of the instance for the given program. Can be `true`&#124;`false` or omitted. |
| `updatedAfter` (mis à jour après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Seules les inscriptions mises à jour après cette date |
| `updatedWithin` | `Durée` | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Seules les inscriptions mises à jour depuis une durée donnée |
| `enrolledAfter` (inscrit après) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Seules les inscriptions plus récentes que cette date |
| `enrolledBefore` (inscrit avant) | `DateTime` (date et heure) | [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) | Seules les inscriptions antérieures à cette date |
| `TrackedEntityType` (Type d'entité suivie) | `Chaîne` | `uid` | Identifiant du type d'entité suivie |
| `trackedEntity` (entité suivie) | `Chaîne` | `uid` | Identifiant de l'instance d'entité suivie |
| `inscription` | `Chaîne` | Liste d'`uid` délimités par des virgules | Filtre le résultat pour obtenir un ensemble limité d’identifiants en utilisant enrollement=id1;id2. |
| `includeDeleted` (inclure les éléments supprimés) | `Booléen` |  | S'il est défini sur "vrai", les événements supprimés mais pas définitivement seront inclus dans le résultat de votre requête. |

La requête n'est pas sensible à la casse. Les règles suivantes s'appliquent aux paramètres de la requête.

-   At least one organisation unit must be specified using the `orgUnit` parameter (one or many), or _ouMode=ALL_ must be specified.

-   Only one of the _program_ and _trackedEntity_ parameters can be specified (zero or one).

-   If _programStatus_ is specified, then _program_ must also be specified.

-   If _followUp_ is specified, then _program_ must also be specified.

-   If _enrolledAfter_ or _enrolledBefore_ is specified, then _program_ must also be specified.

##### Example requests { #example-requests }

A query for all enrollments associated with a specific organisation unit can look like this:

    GET /api/tracker/enrollments?orgUnit=DiszpKrYNg8

To constrain the response to enrollments which are part of a specific program you can include a program query parameter:

    GET /api/tracker/enrollments?orgUnit=O6uvpzGd5pu&ouMode=DESCENDANTS&program=ur1Edk5Oe2n

Pour spécifier les dates d'inscription au programme dans la requête :

    GET /api/tracker/enrollments?&orgUnit=O6uvpzGd5pu&program=ur1Edk5Oe2n
      &enrolledAfter=2013-01-01&enrolledBefore=2013-09-01

To constrain the response to enrollments of a specific tracked entity you can include a tracked entity query parameter:

    GET /api/tracker/enrollments?orgUnit=O6uvpzGd5pu&ouMode=DESCENDANTS&trackedEntity=cyl5vuJ5ETQ

To constrain the response to enrollments of a specific tracked entity you can include a tracked entity instance query parameter, in In this case, we have restricted it to available enrollments viewable for current user:

    GET /API/tracker/enrollments?ouMode=ACCESSIBLE&trackedEntity=tphfdyIiVL6

##### Response format { #response-format }

La réponse `JSON` peut ressembler à ceci :

```json
{
    "instances": [
        {
            "enrollment": "iKaBMOyq7QQ",
            "createdAt": "2017-03-28T12:28:19.812",
            "createdAtClient": "2016-03-28T12:28:19.812",
            "updatedAt": "2017-03-28T12:28:19.817",
            "trackedEntity": "PpqV8ytvW5i",
            "trackedEntityType": "nEenWmSyUEp",
            "program": "ur1Edk5Oe2n",
            "status": "ACTIVE",
            "orgUnit": "NnQpISrLYWZ",
            "orgUnitName": "Govt. Hosp. Bonthe",
            "enrolledAt": "2020-10-23T12:28:19.805",
            "occurredAt": "2020-10-07T12:28:19.805",
            "followUp": false,
            "deleted": false,
            "events": [],
            "relationships": [],
            "attributes": [],
            "notes": []
        }
    ],
    "page": 1,
    "total": 1,
    "pageSize": 5
}
```

#### Point d'extrémité d'objet unique d'inscriptions `GET /api/tracker/enrollments/{uid}`

Le but de ce point d'extrémité est de récupérer une inscription en se basant sur son UID.

##### Request syntax { #request-syntax }

`GET /api/tracker/enrollment/{uid}`

| Paramètre de requête | Type | Valeurs autorisées | Description |
| --- | --- | --- | --- |
| `uid` | `Chaîne` | `uid` | Renvoie l'inscription disposant de l'`uid` spécifié |
| `champs` | `Chaîne` | Tout filtre de champ valide (par défaut `*,!relationships,!events,!attributes`) | Inclut les sous-objets spécifiés dans la réponse |

##### Example requests { #example-requests }

Une requête pour une inscription :

    GET /api/tracker/enrollments/iKaBMOyq7QQ

##### Response format { #response-format }

```json
{
    "enrollment": "iKaBMOyq7QQ",
    "createdAt": "2017-03-28T12:28:19.812",
    "createdAtClient": "2016-03-28T12:28:19.812",
    "updatedAt": "2017-03-28T12:28:19.817",
    "trackedEntity": "PpqV8ytvW5i",
    "trackedEntityType": "nEenWmSyUEp",
    "program": "ur1Edk5Oe2n",
    "status": "ACTIVE",
    "orgUnit": "NnQpISrLYWZ",
    "orgUnitName": "Govt. Hosp. Bonthe",
    "enrolledAt": "2020-10-23T12:28:19.805",
    "occurredAt": "2020-10-07T12:28:19.805",
    "followUp": false,
    "deleted": false,
    "events": [],
    "relationships": [],
    "attributes": [],
    "notes": []
}
```

### Relationships (`GET /api/tracker/relationships`) { #relationships-get-apitrackerrelationships }

Relationships are links between two entities in the Tracker. These entities can be tracked entity instances, enrollments, and events.

Le but de ce point d'extrémité est de récupérer les relations entre les objets.

Contrairement aux autres points d'extrémité d'objets suivis, les relations n'exposent qu'un seul point d'extrémité :

-   `GET /api/tracker/relationships?[trackedEntity={trackedEntityUid}|enrollment={enrollmentUid}|event={eventUid}]&fields=[fields]`

#### Request parameters { #request-parameters }

| Paramètre de requête | Type | Valeurs autorisées | Description |
| --- | --- | --- | --- |
| `trackedEntity` (entité suivie) | `Chaîne` | `uid` | Identifiant d'une instance d'entité suivie |
| `inscription` | `Chaîne` | `uid` | Identifiant d'une inscription |
| `événement` | `Chaîne` | `uid` | Identifiant d'un événement |
| `champs` | `Chaîne` | Tout filtre de champ valide (par défaut `relationship,relationshipType,from[trackedEntity[trackedEntity],enrollment[enrollment],event[event]],to[trackedEntity[trackedEntity],enrollment[enrollment],event[event]]`) | Inclut les sous-objets spécifiés dans la réponse |

Les règles suivantes s'appliquent aux paramètres de requête.

-   un seul paramètre parmi `trackedEntity`, `enrollment` et `event` peut être transmis

> **NOTE**
>
> Using tracked entity, Enrollment or Event params, will return any relationship where the trackedEntity, enrollment or event is part of the relationship (either from or to). As long as user has access, that is.

#### Example response { #example-response }

```json
{
    "instances": [
        {
            "relationship": "SSfIicJKbh5",
            "relationshipType": "Mv8R4MPcNcX",
            "from": {
                "trackedEntity": {
                    "trackedEntity": "neR4cmMY22o"
                }
            },
            "to": {
                "trackedEntity": {
                    "trackedEntity": "rEYUGH97Ssd"
                }
            }
        },
        {
            "relationship": "S9kZGYPKk3x",
            "relationshipType": "Mv8R4MPcNcX",
            "from": {
                "trackedEntity": {
                    "trackedEntity": "neR4cmMY22o"
                }
            },
            "to": {
                "trackedEntity": {
                    "trackedEntity": "k8TU70vWtnP"
                }
            }
        }
    ],
    "page": 1,
    "pageSize": 2
}
```

## Contrôle de l'accès au Tracker { #webapi_nti_access_control }

Le Tracker a quelques concepts différents en ce qui concerne le contrôle d'accès, tels que le partage, les champs d'application des unités d'organisation, la propriété et les niveaux d'accès. Les sections suivantes fournissent une brève introduction aux différents sujets.

### Partage de métadonnées { #webapi_nti_metadata_sharing }

Le paramètre de partage est une fonctionnalité standard de DHIS2 qui s'applique aux métadonnées/données du Tracker et de l'Agrégé, ainsi qu'aux tableaux de bord et aux éléments de visualisation. Au cœur du partage se trouve la possibilité de définir qui peut voir/faire quoi. En général, il existe cinq configurations de partage possibles : aucun accès, lecture des métadonnées, écriture des métadonnées, lecture des données et écriture des données. Ces configurations d'accès peuvent être accordées au niveau de l'utilisateur et/ou du groupe d'utilisateurs (pour plus de flexibilité). En ce qui concerne le Tracker, les métadonnées suivantes et leur configuration de partage sont d'une importance particulière : Élément de données, option de catégorie, programme, étape de programme, type d'entité suivie, attribut d'entité suivie, ainsi que les tableaux de bord et les éléments de tableau de bord liés au Tracker.

Le fonctionnement des paramètres de partage est simple : les paramètres sont appliqués lors des processus d'importation/exportation des données Tracker. Pour lire des valeurs, il faut disposer d'un accès en lecture aux données. Un utilisateur qui souhaite modifier des données doit disposer d'un accès en écriture. De même, un utilisateur qui souhaite modifier des métadonnées doit disposer d'un accès en écriture aux métadonnées.

Un point essentiel concernant les données Tracker est la nécessité d'adopter une approche holistique.
Par exemple, un utilisateur ne pourra pas voir la valeur de l'élément de données s'il n'a accès qu'à l'élément de données en lecture. L'utilisateur doit disposer d'un accès en lecture aux données pour accéder au stade du programme parent et au programme auquel l'élément de données appartient. Il en va de même pour la combinaison d'options de catégorie. Dans Tracker, l'événement est lié à AttributeOptionCombo, qui se compose d'une combinaison d'options de catégorie. Par conséquent, pour qu'un utilisateur puisse lire les données d'un événement, il doit avoir un accès en lecture à toutes les options de catégorie et aux catégories correspondantes qui constituent la combinaison d'options d'attributs de l'événement en question. Si un utilisateur n'a pas accès à une seule option de catégorie ou à une seule catégorie, il n'a pas accès à l'ensemble de l'événement.

Lorsqu'il s'agit d'accéder aux données d'inscription, il est essentiel d'avoir d'abord accès à l'entité suivie. L'accès à une entité suivie est contrôlé par le partage des paramètres du programme, du type d'entité suivie et de l'attribut d'entité suivie. Une fois que l'on a accédé à l'inscription, il est possible d'accéder aux données d'événement, là encore en fonction de l'étape du programme et des paramètres de partage des éléments de données.

Un autre point essentiel à prendre en considération est la manière de définir l'accès aux différentes étapes d'un programme. Il peut arriver que nous devions accorder l'accès à une étape spécifique - par exemple, « Résultat de laboratoire » - à un groupe d'utilisateurs spécifique (techniciens de laboratoire). Dans ce cas, nous pouvons accorder un accès en écriture aux données de l'étape « Résultat du laboratoire », probablement un accès en lecture à une ou plusieurs étapes au cas où nous voudrions que les techniciens de laboratoire lisent d'autres résultats médicaux, ou aucun accès si nous pensons qu'il n'est pas nécessaire qu'ils consultent des données autres que celles relatives au laboratoire.

En résumé, DHIS2 dispose d'un paramètre de partage très précis que nous pouvons utiliser pour implémenter les mécanismes de contrôle d'accès au niveau des données et des métadonnées. Ces paramètres de partage peuvent être appliqués directement au niveau de l'utilisateur ou du groupe d'utilisateurs. Le paramètre de partage à appliquer dépend du cas d'utilisation.

Pour plus d'informations sur le partage de données, consultez [Partage de données](https://docs.dhis2.org/en/use/user-guides/dhis-core-version-master/configuring-the-system/about-sharing -of-objects.html#data-sharing-for-event-based-programs).

### Champs d'application des unités d'organisation { #webapi_nti_ou_scope }

Les unités d'organisation font partie des objets les plus fondamentaux de DHIS2. Elles définissent un univers dans lequel un utilisateur est autorisé à enregistrer et/ou à lire des données. Trois types d'unités d'organisation peuvent être attribués à un utilisateur. Il s'agit de la saisie de données, de la consultation de données et de la recherche Tracker. Comme leur nom l'indique, ces unités d'organisation définissent un champ d'application dans lequel un utilisateur est autorisé à effectuer les opérations requises.

However, to further fine-tune the scope, DHIS2 Tracker introduces a concept that we call **OrganisationUnitSelectionMode**. Such a mode is often used at the time exporting tracker objects. For example, given that a user has a particular tracker search scope, does it mean that we have to use this scope every time a user tries to search for a tracker, Enrollment, or Event object? Or is the user interested in limiting the searching just to the selected org unit, or the entire capture org unit scope, and so on.

Les utilisateurs peuvent affiner un champ d'application en transmettant une valeur spécifique de ouMode (mode d'unité d'organisation) dans leur requête API :

_api/tracker/trackedEntities?orgUnit=UID&ouMode=specific_organisation_unit_selection_mode_

Currently, there are six selection modes available: _SELECTED, CHILDREN, DESCENDANTS, CAPTURE, ACCESSIBLE, and ALL_.

1. **SÉLECTIONNÉ** : comme son nom l'indique, toutes les opérations prévues par l'API qui fait la requête se limitent à l'unité d'organisation sélectionnée.
2. **CHILDREN**: under this mode, the organisation unit scope will be constructed using the selected organisation unit and its immediate children.
3. **DESCENDANTS** : ici, il s'agit de l'unité d'organisation sélectionnée et toutes les unités qui se trouvent en dessous de celle-ci, pas seulement les subordonnés immédiats.
4. **SAISIE** : comme le nom l'indique, il s'agit ici des unités d'organisation destinées à la saisie des données. Il convient de noter que, parmi les trois unités d'organisation pouvant être attribuées à un utilisateur, celle de la saisie de données est obligatoire. Si un utilisateur ne dispose pas d'unités d'organisation pour la visualisation des données et pour la recherche Tracker, le système reviendra à la saisie des données. De cette manière, nous sommes toujours sûrs que l'utilisateur possède au moins un univers.
5. **ACCESSIBLE** : techniquement, il s'agit du même champ d'application que les unités d'organisation de recherche Tracker de l'utilisateur.
6. **TOUS** : "TOUS" s'applique parfaitement aux superutilisateurs. Pour ces derniers, ce champ d'application désigne toutes les unités d’organisation disponibles dans le système. Cependant, pour les non-superutilisateurs, TOUS se limite aux unités d'organisation ACCESSIBLES.

Il n'est pas judicieux de transmettre ces modes lors des opérations d'importation du Tracker. En effet, lors de l'écriture des données Tracker, chaque objet doit être rattaché à une unité d'organisation spécifique. Le système vérifiera alors si chacune des unités d'organisation mentionnées relève du champ d'application de la SAISIE. Si ce n'est pas le cas, le système rejettera simplement l'opération d'écriture.

Note that there is 4 type of organisation unit associations relevant for Tracker objects. A TrackedEntity has an organisation unit, commonly referred to as the Registration Organisation unit. Enrollments have an organisation unit associated with them. Events also have an organisation unit associated with them. There is also an Owner organisation unit for a TrackedEntity-Program combination.

When fetching Tracker objects, depending on the context, the organisation unit scope is applied to one of the above four organisation unit associations.

For example, when retrieving TrackedEntities without the context of a program, the organisation unit scope is applied to the registration organisation unit of the TrackedEntity. Whereas, when retrieving TrackedEntities, including specific program data, the organisation unit scope is applied to the Owner organisation unit.

-   **Explain how they relate to ownership - Link to Program Ownership**

### Propriété du programme Tracker { #webapi_nti_ownership }

A new concept called Tracker Ownership is introduced from 2.30. This introduces a new organisation unit association for a TrackedEntity - Program combination. We call this the Owner (or Owning) Organisation unit of a TrackedEntity in the context of a Program. The Owner organisation unit is used to decide access privileges when reading and writing tracker data related to a program. This, along with the Program's [Access Level](#webapi_nti_access_level) configuration, decides the access behavior for Program-related data (Enrollments and Events). A user can access a TrackedEntity's Program data if the corresponding Owner OrganisationUnit for that TrackedEntity-Program combination falls under the user's organisation unit scope (Search/Capture). For Programs that are configured with access level _OPEN_ or _AUDITED_ , the Owner OrganisationUnit has to be in the user's search scope. For Programs that are configured with access level _PROTECTED_ or _CLOSED_ , the Owner OrganisationUnit has to be in the user's capture scope to be able to access the corresponding program data for the specific tracked entity.

#### Remplacement de la propriété du Tracker : briser le verre { #webapi_nti_tracker_ownership_override }

It is possible to temporarily override this ownership privilege for a program that is configured with an access level of _PROTECTED_. Any user will be able to temporarily gain access to the Program related data if the user specifies a reason for accessing the TrackedEntity-Program data. This act of temporarily gaining access is termed as _breaking the glass_. Currently, temporary access is granted for 3 hours. DHIS2 audits breaking the glass along with the reason specified by the user. It is not possible to gain temporary access to a program that has been configured with an access level of _CLOSED_. To break the glass for a TrackedEntity-Program combination, the following POST request can be used:

    /API/33/tracker/ownership/override?trackedEntityInstance=DiszpKrYNg8
      &program=eBAyeGv0exc&reason=patient+showed+up+for+emergency+care

#### Transfert de la propriété du Tracker { #webapi_nti_tracker_ownership_transfer }

It is possible to transfer the ownership of a TrackedEntity-Program from one organisation unit to another. This will be useful in case of patient referrals or migrations. Only a user who has Ownership access (or temporary access by breaking the glass) can transfer the ownership. To transfer ownership of a TrackedEntity-Program to another organisation unit, the following PUT request can be used:

    /API/33/tracker/ownership/transfer?trackedEntityInstance=DiszpKrYNg8
      &program=eBAyeGv0exc&ou=EJNxP3WreNP

### Niveau d'accès { #webapi_nti_access_level }

DHIS2 treats Tracker data with an extra level of protection. In addition to the standard feature of metadata and data protection through sharing settings, Tracker data are shielded with additional access level protection mechanisms. Currently, there are four access levels that can be configured for a Program: Open, Audited, Protected, and Closed.

These access levels are only triggered when users try to interact with program data, namely Enrollments and Events data. The different Access Level configuration for Program is a degree of openness (or closedness) of program data. Note that all other sharing settings are still respected, and the access level is only an additional layer of access control. Here is a short description of the four access levels that can be configured for a Program.

1. Open: This access level is the least restricted among the access levels. Data inside an OPEN program can be accessed and modified by users if the Owner organisation unit falls under the user's search scope. With this access level, accessing and modifying data outside the capture scope is possible without any justification or consequence.
2. Audited: This is the same as the Open access level. The difference here is that the system will automatically add an audit log entry on the data being accessed by the specific user.
3. Protected: This access level is slightly more restricted. Data inside a PROTECTED program can only be accessed by users if the Owner organisation unit falls under the user's capture scope. However, a user who only has the Owner organisation unit in the search scope can gain temporary ownership by [breaking the glass](#webapi_nti_tracker_ownership_override). The user has to provide a justification of why they are accessing the data at hand. The system will then put a log of both the justification and access audit and provide temporary access for 3 hours to the user. Note that when breaking the glass, the Owner Organisation Unit remains unchanged, and only the user who has broken the glass gains temporary access.
4. Closed: This is the most restricted access level. Data recorded under programs configured with access level CLOSED will not be accessible if the Owner Organisation Unit does not fall within the user's capture scope. It is also not possible to break the glass or gain temporary ownership in this configuration. Note that it is still possible to transfer the ownership to another organisation unit. Only a user who has access to the data can transfer the ownership of a TrackedEntity-Program combination to another Organisation Unit. If ownership is transferred, the Owner Organisation Unit is updated.
