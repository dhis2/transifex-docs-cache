---
edit_url: "https://github.com/dhis2/dhis2-docs/blob/2.36/src/user/using-the-maps-app.md"
revision_date: "2021-06-14"
tags:
    - 使用
    - DHIS 核心 2.36 版
---

# 使用地图应用 { #using_maps }

## 关于地图应用 { #about_maps }

地图应用程序在 2.29 版中引入并作为替代
GIS 应用程序提供更直观和用户友好的界面。
2.34 版本的映射引擎基于 WebGL 技术，
能够同时在地图上显示数千个特征。

使用地图应用程序，您可以覆盖多个图层并从中选择
不同的底图。您可以创建区域和点的专题地图，
根据分类查看设施，并可视化集水区
每个设施。您可以为区域和点添加标签，并搜索
并使用各种标准进行过滤。您可以移动点并设置位置
在飞行中。地图可以保存为收藏夹并与其他用户共享
和组，或作为图像下载。

> **注**
>
> 要在**地图**应用程序中使用预定义图例，您需要先在**维护**应用程序中创建它们。

![](resources/images/maps/maps_main.png)

-   工作区左侧的 **图层面板 **显示了当前地图的图层概览：

    -   使用 **(+) 添加图层** 按钮添加图层后，这些图层将在此面板中进行排列和管理。

    -    **底图 **始终显示在面板中。默认底图是OSM Light，默认情况下处于选中状态。 OpenStreetMap Details包含更多地图特征和地名。 Bing Maps提供了4种底图，替代了先前版本中提供的Google Maps。必应之路和必应之暗显示了道路，边界和地方。如果地图图层上的颜色较亮，请使用深色版本。 Bing航空和Bing航空标签shos卫星和详细的航空影像。通过选择所需的图像在它们之间切换。

    -   图层面板右侧顶部的小箭头按钮可以隐藏或显示面板。

<!-- end list -->

-   左上角的 **文件**按钮可用于打开和保存地图：

    -   新

        将清除所有现有地图图层以创建新地图。

    -   打开

        将显示一个对话框，其中包含现有地图的列表，这些地图将在其中打开，重命名，共享和删除。 _当前地图的标题显示在文件按钮上方的标题栏中_。

    -   保存

        会将所有更改保存到当前地图。

    -   另存为

        将使用新名称保存当前地图。

    -   改名

        允许您更改当前地图的名称和/或描述。

    -   翻译

        允许您翻译当前地图的名称和/或描述。

    -   分享

        将打开一个对话框，在该对话框中可以与所有人或一组用户共享当前地图。

    -   获取链接

        将提供直接链接到当前地图。

    -   删除

        删除当前地图。

<!-- end list -->

-   文件按钮旁边的 **下载**按钮可让您将当前地图下载为PNG图像。

<!-- end list -->

-   右上角的**解释**按钮将在工作区的右侧打开一个解释面板。仅在保存了地图的情况下该按钮才可单击。

    -   **地图详细信息**显示有关当前地图的信息。

    -   通过**释义**，您可以查看、添加、编辑和共享有关当前地图的释义。

<!-- end list -->

-   地图上的**+**和**-**按钮可分别放大和缩小地图。鼠标滚轮缩放是连续的，这样我们就能根据您的内容完美地调整地图。

-   使用**旋转地图**按钮（三角形箭头）可以旋转和倾斜地图，以增强数据视图。在移动鼠标时按下按钮（或键盘上的Control键）以更改地图视图。再次单击以重置视图。

-   **全屏**（四个箭头）允许您全屏查看地图。要退出全屏，请再次单击该按钮或键盘上的 Escape 键。

*   **缩放至内容**（有边框的放大镜符号）可自动调整缩放级别和地图中心位置，使地图上的数据成为焦点。

*   **搜索**（放大镜符号）允许搜索和跳转到地图上的某个位置。

*   使用**直尺**按钮，您可以测量地图上的距离和面积。

*   右键单击地图可显示该位置的经度和纬度。

**底图**

底图图层由图层面板中的图层 _cards_ 表示，例如
作为：

![](resources/images/maps/maps_basemap_card.png)

在底图卡的顶部，从左到右分别是：

-   所选底图的标题

-   折叠和展开底图卡的箭头符号

底图卡片的中间是可用底图的列表。这
当前底图突出显示。

底图卡的底部是：

-   用于切换图层可见性的眼睛符号

-   用于修改图层透明度的滑块

## 建立新地图 { #using_maps_create_map }

1.  在**应用**菜单中，单击**地图**。随即打开**DHIS2 Maps**窗口。

2.  点击左上角的 (+) 添加图层按钮。您将看到图层选择对话框：

    ![](resources/images/maps/maps_layer_selection.png)

3.  选择要添加到当前地图的图层。可能的选项是：

    -   [专题](#using_maps_thematic_layer)

    -   [事件](#using_maps_event_layer)

    -   [跟踪实体](#using_maps_tracked_entity_layer)

    -   [设施](#using_maps_facility_layer)

    -   [边界](#using_maps_boundary_layer)

    此外，谷歌地球引擎和其他服务还提供了多个图层：

    -   人口

    -   人口年龄组

    -   海拔

    -   沉淀

    -   温度

    -   土地覆盖

    _Labels overlay_ 是维护程序中定义的[外部图层]（#using_maps_external_map_layer）。

## 管理主题层 { #using_maps_thematic_layer }

_专题图_代表地理分布的空间变化。
选择您想要的指标/数据元素、周期和
组织单位层面。如果您的数据库有坐标并聚合
这些组织单位的数据值，它们将出现在地图上。

> **注**
>
> 您必须生成 DHIS2 分析表，才能获得汇总数据值。

![](resources/images/maps/maps_thematic_mapping.png)

专题图层由图层面板中的图层 _cards_ 表示，例如
作为：

主题卡的顶部从左到右分别是：

-   抓取字段，允许使用鼠标拖动和重新排序图层

-   与图层关联的标题和时期

-   折叠和展开主题卡片的箭头符号

主题卡的中间是一个图例，表示价值
显示在图层上的范围。

主题卡的底部从左到右分别是：

-   编辑（铅笔）按钮以打开图层配置对话框

-   用于切换图层可见性的眼睛符号

-   用于修改图层透明度的滑块

-   具有更多选项的更多操作（三个点）按钮：

    -   **数据表**切换按钮可显示或隐藏与图层关联的数据表

    -   **下载数据**允许您以GeoJSON格式下载此图层的数据，以供其他地图软件使用

    -   **编辑图层**与上方的编辑按钮相同

    -   **移除图层**将从当前地图中移除该图层。

### 创建一个主题层 { #create-a-thematic-layer }

要创建事件层，请在**添加层**选择上选择**主题**。这将打开“事件”层配置对话框。

1.  在**数据**标签中：

    ![](resources/images/maps/maps_thematic_layer_dialog_DATA.png)

    -   选择数据类型，然后分别选择组和目标元素。可用字段取决于所选项目的类型。

    -   从**汇总类型**字段中选择一个值，以将数据值显示在地图上。默认情况下，“按数据元素”处于选中状态。替代值是：计数；平均数;和;标准偏差方差;敏最大限度。另请参阅[聚合运算符] [Aggregation operators](https://dhis2.github.io/dhis2-docs/master/en/user/html/ch10s05.html#d0e8082)。

2.  在**期间**标签中

    ![](resources/images/maps/maps_thematic_layer_dialog_PERIOD.png)

    -   选择映射专题数据的时间跨度。您可以选择相对时间段或固定时间段。

        -   相对时期

            在**期间类型**字段中，选择**相对**，然后在**期间**字段中选择一个相对期间，例如**去年**或**过去12个月**。

            可以在**系统设置**应用中设置**分析的默认相对周期**。

            如果您选择的相对时间段涵盖多个年/月/周/日，该图层可以显示为

            -   单（合计）

                显示所选相对期间的汇总值（默认）。

            -   时间线

                包括一个时间轴，让您可以逐步穿越各个时期。同一地图上只能添加一个时间轴图层。

            -   拆分地图视图

                显示多张地图，可并排比较不同时期。支持 12 个项目或以下的相对时段。不能与其他图层类型结合使用。

        -   固定期间

            在**期间类型**字段中，选择期间长度，然后在**期间**字段中选择目标。

        -   开始/结束日期

            在**期间类型**字段中，选择**开始/结束日期**，然后填写开始日期和结束日期。

3.  在**ORG UNITS**标签中：

    ![](resources/images/maps/maps_thematic_layer_dialog_ORG_UNITS.png)

    -   选择要包含在图层中的组织单位。可以选择

        -   一个或多个特定的组织单位、组织单位层次结构中的层级、组织单位组，或

        -   组织单位层次结构中相对于用户的相对级别。通过选择**用户组织单位**，对于组织单位层次结构中不同级别的用户，地图数据将以不同的方式显示。

4.  在**过滤器**标签中：

    ![](resources/images/maps/maps_thematic_layer_dialog_FILTER.png)

    -   单击 "添加过滤器 "并选择一个可用的数据项，为数据集添加一个新的过滤器。

        -   从下拉框中选择数据维度。使用搜索栏可以减少显示的维度数量。点击名称选择维度。

        -   选择维度后，会出现第二个下拉菜单，其中包含维度项目。选中要包含在筛选器中的项目。

        可添加多个筛选器。单击过滤器右侧的垃圾按钮可将其删除。

5.  在**样式**标签中：

    ![](resources/images/maps/maps_thematic_layer_dialog_STYLE.png)

    -   选择**钟形**或**气泡图**。

        -   Choropleth 将根据数据值为每个 org 单位形状分配一种颜色。如果数据是标准化的（人均），建议使用这种技术。

        -   气泡图会将数据值显示为成比例的圆圈。如果数据没有标准化（绝对数字），请使用此技术。圆圈位于每个 org 单位的中心。

    -   为比例圆或点设施设置**低半径**和**高半径**。圆将根据数据值在低半径和高半径之间缩放。半径必须在0到50像素之间。

    -   **显示标签**：允许在图层上显示 org 单位名称。字体大小、重量、样式和颜色均可在此修改。

    -   **显示无数据**：默认情况下，缺失数据值的 org 单位不会显示在地图上。如果想用颜色显示，请选中此复选框。点击颜色进行更改。

    -   选择图例类型：

        -   **自动彩色图例**：应用程序将根据您选择的分类方法、类别数量和色标为您创建图例。将**分类**设置为：

            -   等间隔

                每个间隔的范围将是（最高数据值-最低数据值/类数）

            -   均数

                图例创建者将尝试平均分配组织单位。

        -   **预定义的颜色图例**：在预定义的图例之间进行选择。

        -   **单色图例**：选择气泡或圆圈的颜色。仅适用于气泡图。

6.  点击**添加图层**。

### 修改主题层 { #modify-a-thematic-layer }

1.  在图层面板中，单击主题图层卡上的编辑（铅笔）图标。

2.  根据需要修改任何选项卡上的设置。

3.  点击**更新图层**。

### 筛选主题层中的值 { #filter-values-in-a-thematic-layer }

专题图层有一个 **data table** 选项，可以打开或
从专题图层卡上关闭。

![](resources/images/maps/maps_thematic_layer_data_table.png)

数据表显示构成主题层的数据。

-   点击标题将根据该列对表格进行排序；在升序和降序之间切换。

-   在标题下方的筛选字段中输入文本或表达式，将对数据应用这些筛选，显示内容将根据筛选进行调整。筛选器的应用如下：

    -   名称

        按包含给定文本的名称过滤

    -   值

        根据给定的数字和/或范围过滤数值，例如：2,\>3&\<8

    -   传说

        按图例过滤并包含给定的文本

    -   范围

        按包含给定文本的范围过滤

    -   水平

        按数字和/或范围过滤级别，例如：2，\> 3＆\ <8

    -   父母

        按包含给定文本的父项名称过滤

    -   身份证

        按包含给定文本的ID进行过滤

    -   类型

        按包含给定文本的GIS显示类型过滤

    -   颜色

        按包含给定文本的颜色名称过滤

> **注**
>
> 数据表筛选器是临时的，不会作为收藏夹的一部分与地图图层一起保存。

### 搜索组织单位 { #search-for-an-organisation-unit }

数据表中的 NAME 过滤器字段提供了一种有效的方法
搜索单个组织单位。

### 在组织层次结构之间导航 { #navigate-between-organisation-hierarchies }

当地图上有可见的组织单位时，您可以轻松地
在不使用级别/父级的情况下在层次结构中上下导航
用户界面。

1.  右键单击组织单位之一。

2.  选择**向上钻取一级**或**向下钻取一级**。

    如果您在最低层，或者下一层没有可用坐标，则向下钻取选项将被禁用。同样，从最高层向上钻取选项也被禁用。

### 删除主题层 { #remove-thematic-layer }

要清除主题层中的所有数据：

1.  在左侧的图层卡中，单击_more actions_（三个点）图标，然后在**删除图层**上单击。

    该图层将从当前地图中删除。

## 管理事件层 { #using_maps_event_layer }

事件层显示注册事件的地理位置
在 DHIS2 跟踪器中。只要事件具有关联的点或多边形
坐标，您可以使用此图层从聚合的
显示在专题层中的数据给底层个人
事件或案例。

您还可以在设施或在
边界水平。您可以使用事件数据通过专题图层执行此操作
项目。当您只有 Org 的坐标时，这很有用
记录事件的单位。

![](resources/images/maps/maps_event_layer.png)

事件层由层面板中的层 _cards_ 表示，例如
作为：

在事件卡的顶部，从左到右分别是：

-   抓取字段，允许使用鼠标拖动和重新排序图层

-   与图层关联的标题和时期

-   折叠和扩展事件卡的箭头符号

在事件卡的中间是一个说明样式的图例
层。

在事件卡的底部，从左到右分别是：

-   编辑（铅笔）按钮以打开图层配置对话框

-   用于切换图层可见性的眼睛符号

-   用于修改图层透明度的滑块

-   具有更多选项的更多操作（三个点）按钮：

    -   **数据表**切换按钮可显示或隐藏与图层关联的数据表

    -   **下载数据**允许您以GeoJSON格式下载此图层的数据，以供其他地图软件使用

    -   **编辑图层**与上方的编辑按钮相同

    -   **移除图层**将从当前地图中移除该图层。

### 创建一个事件层 { #maps_create_event_layer }

要创建事件层，请在**添加层**选择上选择**事件**。这将打开事件层配置对话框。

1.  在**数据**标签中：

    ![](resources/images/maps/maps_event_layer_dialog_DATA.png)

    -   选择一个项目，然后选择一个项目阶段。仅在选择项目后才显示**阶段**字段。

        如果所选程序只有一个阶段可用，则会自动选择该阶段。

    -   从**坐标字段**中为地图上显示的位置选择一个值。默认情况下，选择“事件位置”。根据属于程序的数据元素或属性，还可以使用其他坐标，例如“住所位置”。

    -   默认情况下，所有带有坐标的事件都显示在地图上。使用**事件状态**字段仅显示具有以下一种状态的事件：有效，已完成，计划，过期或已跳过。

2.  在**期间**标签中

    ![](resources/images/maps/maps_event_layer_dialog_PERIOD.png)

    -   选择事件发生的时间跨度。您可以选择固定时间段或相对时间段。

        -   相对时期

            在**期间**字段中，选择一个相对期间，例如**本月**或**去年**。

            可以在**系统设置**应用中设置**分析的默认相对周期**。

        -   固定期间

            在**期间**字段中，选择**开始/结束日期**，然后填写开始日期和结束日期。

3.  在**ORG UNITS**标签中：

    ![](resources/images/maps/maps_event_layer_dialog_ORG_UNITS.png)

    -   选择要包含在图层中的组织单位。可以选择

        -   一个或多个特定的组织单位，或

        -   组织单位层次结构中相对于用户的相对级别。通过选择**用户组织单位**，对于组织单位层次结构中不同级别的用户，地图数据将以不同的方式显示。

4.  在**过滤器**标签中：

    ![](resources/images/maps/maps_event_layer_dialog_FILTER.png)

    -   单击 "添加过滤器 "并选择一个可用的数据项，为数据集添加一个新的过滤器。

        -   对于_选项集_类型的数据项，您可以使用向下箭头从下拉框中选择任何选项，或直接在框中开始键入，以筛选选项。

        -   对于 _number_ 类型的数据项，可以选择等于、不等于、大于或小于等运算符。

        -   对于 _boolean_（是/否）类型的数据项，如果条件有效或为真，则可以选中该复选框。

        -   对于_text_类型的数据项，您将有两种选择：**包含**表示查询将匹配包含您的搜索值的所有值，**是精确**表示仅与搜索查询完全相同的值将被退回。

        可添加多个筛选器。单击过滤器右侧的垃圾按钮可将其删除。

5.  在**样式**标签中：

    ![](resources/images/maps/maps_event_layer_dialog_STYLE.png)

    -   选择**分组事件**以将附近的事件（集群）分组，或选择**查看所有事件**以单独显示事件。

    -   为事件或聚类点选择一种**颜色**。

    -   为事件选择**半径**（1到20之间）。

    -   选择**显示缓冲区**以在每个事件周围显示可视缓冲区。缓冲区的半径可以在这里修改。仅当您选择上面的**查看所有事件**时，此选项才可用。

    -   选择**按数据元素样式 **以根据数据值为事件着色。如果您还选择对事件进行分组，则用户将显示为小的甜甜圈图，以显示数据值的分布。这些选项因不同的数据类型而异：

        -   **选项集**：为选项集中的每个选项选择一种颜色。您可以在维护应用程序中为选项设置默认颜色。

        -   **数字**：您可以使用自动或预定义图例[与专题图层相同的方式]（#using_maps_thematic_layer_style）为数字数据元素设计样式。

        -   **布尔值**：选择一种颜色表示 "真"/"是"，另一种颜色表示 "假"/"否"。

6.  点击**添加图层**。

### 修改事件层 { #modify-an-event-layer }

1.  在图层面板中，单击事件图层卡上的编辑（铅笔）图标。

2.  根据需要修改 DATA（数据）、PERIOD（周期）、FILTER（滤波器）、ORG UNIT（组织单位）和 STYLE（风格）选项卡上的设置。

3.  点击**更新图层**。

### 列出和过滤事件 { #listing-and-filtering-events }

事件层有一个 **data table** 选项，可以打开或
从事件层卡上关闭。

![](resources/images/maps/maps_event_layer_data_table.png)

数据表显示构成事件层的数据。

-   点击标题将根据该列对表格进行排序；在升序和降序之间切换。

-   在标题下方的筛选字段中输入文本或表达式，将对数据应用这些筛选，显示内容将根据筛选进行调整。筛选器的应用如下：

    -   身份证

        按包含给定文本的事件ID进行过滤

    -   组织单位

        按包含给定文本的组织单位名称过滤

    -   活动时间

        按包含给定文本的事件时间过滤

    -   类型

        按包含给定文本的GIS显示类型过滤

    -   **通过数据元素**样式：如果事件是按数据元素（如性别）设置的样式，则数据值和颜色都可以过滤。

    -   **在报告中显示**：选中在报告中显示的数据元素将显示在单独的列中（请参阅下面的添加方法）。

    -   数值数据值可通过给定的数字和/或范围进行筛选，例如：2,\>3&\<8

> **注**
>
> 数据表筛选器是临时的，不会作为收藏夹的一部分与地图图层一起保存。

### 修改事件数据表和弹出窗口中的信息 { #modify-information-in-event-data-table-and-popups }

您可以修改事件弹出窗口中显示的信息。

![](resources/images/maps/maps_eventlayer_eventinfopopup.png)

1.  打开**维护**应用程序。

2.  选择**程序**。

3.  单击要修改的程序，然后选择** 2分配数据元素**。

4.  对于要在弹出窗口中显示的每个数据元素，选择相应的**在报告中显示**。

5.  点击**保存**。 

### 下载原始事件层数据 { #download-raw-event-layer-data }

可以以GeoJSON格式下载事件层的原始数据，以便在桌面GIS软件（例如[QGIS]https://www.qgis.org/）中进行更高级的地理分析和处理。下载的数据包括所有单独的事件，作为GeoJSON功能，包括为**在报告中显示**选择的每个数据元素的属性。

![](resources/images/maps/maps_data_download_dialog.png)

-   在左侧的图层卡中，点击_more actions_（三个点）图标，然后点击**下载数据**

-   选择** ID格式**用作下载的GeoJSON文件中数据元素值的键。共有三个选项：

    -   ** ID **-使用数据元素的唯一ID
    -   **名称**-使用数据元素的人性化名称（翻译）
    -   **代码**-使用数据元素的代码

-   选择是否对其他事件属性（例如程序阶段，纬度，经度，事件数据以及组织单位ID，名称和代码）**使用人类可读的键**。如果**未**选中此选项，则这些值将是计算机友好的ID，而不是人类可读（和翻译）的名称。

-   单击**下载**按钮以生成和下载GeoJSON文件。数据将从DHIS2服务器请求并由地图应用程序处理。此操作可能需要几分钟才能完成。

-   一旦下载了GeoJSON文件，就可以将其导入大多数标准GIS软件应用程序中。

>请注意，下载的数据不包含样式信息，因为GeoJSON格式本身不支持它。可以选择使用每个要素的属性在外部GIS应用程序中重新创建样式。

### 清除事件层 { #clear-event-layer }

要清除地图中的所有事件层数据：

1.  在左侧的图层卡中，单击_more actions_（三个点）图标，然后在**删除图层**上单击。

    该图层将从当前地图中删除。

## 管理跟踪的实体层 { #using_maps_tracked_entity_layer }

被追踪实体图层显示被追踪的地理位置
在 DHIS2 中注册的实体。前提是被跟踪的实体有
关联的点或多边形坐标，您可以在地图上探索这些。

![](resources/images/maps/maps_tracked_entity_layer.png)

跟踪实体图层由图层面板中的图层卡片表示
如：

沿着跟踪实体卡的顶部，从左到右分别是：

-   一个抓取区域，允许用鼠标拖动图层并重新排序。

-   与图层关联的标题和时期。

-   箭头符号，用于折叠和展开被跟踪的实体卡。

被追踪实体卡片的中间是一个图例，表明
图层样式。

跟踪实体卡的底部从左到右分别是：

-   编辑（铅笔）按钮以打开图层配置对话框

-   用于切换图层可见性的眼睛符号

-   用于修改图层透明度的滑块

-   具有更多选项的更多操作（三个点）按钮：

    -   **编辑图层**与上方的编辑按钮相同

    -   **移除图层**将从当前地图中移除该图层。

### 创建一个跟踪实体层 { #maps_create_tracked_enity_layer }

要创建跟踪实体层，请在**添加层**选择上选择**跟踪实体**。这将打开跟踪的实体层配置对话框。

1.  在**数据**标签中：

    ![](resources/images/maps/maps_tracked_entity_layer_dialog_DATA.png)

    -   选择要在地图上显示的**跟踪实体类型**。

    -   选择被跟踪实体所属的**程序**。

    -   使用**计划状态**字段选择要跟踪的实体的注册状态，包括：全部，活动，已完成或已取消。

    -   设置给定程序的被跟踪实体的**跟踪**状态。

2.  在**关系**标签中

    ![](resources/images/maps/maps_tracked_entity_layer_dialog_RELATIONSHIPS.png)

    > **Caution**
    >
    > Displaying tracked entity relationships in Maps is an experimental feature

    -   如果选择了跟踪的实体类型，则可以选中**显示跟踪的实体关系**复选框

    -   选中后，您可以从下拉列表中选择要显示在地图上的关系类型。仅来自所选“跟踪的实体”类型的关系可用。

3.  在**期间**标签中

    ![](resources/images/maps/maps_tracked_entity_layer_dialog_PERIOD.png)

    -   如果没有选择程序，则可以设置跟踪实体最后更新的开始和结束日期。

    -   如果选择了计划，则可以设置被跟踪实体最后一次更新的时间段，或者它们注册或加入计划的时间段。

4.  在**ORG UNITS**标签中：

    ![](resources/images/maps/maps_tracked_entity_layer_dialog_ORG_UNITS.png)

    -   选择要包含在图层中的组织单位。您有 3 种选择模式：

        -   仅**选定**：只包括属于选定组织单位的被跟踪实体。

        -   **选定及以下**：包括所选组织单位内和正下方的跟踪实体。

        -   ** 选定和所有以下**：包括所选组织单位中的跟踪实体和所有下面的实体。

5.  在**样式**标签中：

    ![](resources/images/maps/maps_tracked_entity_layer_dialog_STYLE.png)

    -   为跟踪的实体点和多边形选择一种**颜色**。

    -   为点选择**点大小**（半径在 1 到 20 之间）。

    -   选择**显示缓冲区**以在每个被跟踪实体周围显示可视缓冲区。可以在此处修改以米为单位的缓冲距离。

    -   如果在关系选项卡上选择了关系类型，则可以为关系和相关的跟踪实体实例选择**颜色**，**点大小**和**线颜色**

6.  点击**添加/更新图层**。

### 修改跟踪的实体层 { #modify-a-tracked-entity-layer }

1.  在图层面板中，单击跟踪实体图层卡上的编辑（铅笔）图标。

2.  根据需要修改 DATA（数据）、PERIOD（周期）、ORG UNIT（组织单位）和 STYLE（风格）选项卡上的设置。

3.  点击**更新图层**。

### 清除跟踪的实体层 { #clear-a-tracked-entity-layer }

要从地图上清除跟踪的实体层：

1.  在左侧的图层卡中，单击_more actions_（三个点）图标，然后在**删除图层**上单击。

    该图层将从当前地图中删除。

## 管理设施层 { #using_maps_facility_layer }

设施层显示代表设施类型的图标。
多边形不会显示在地图上，因此请确保选择一个
具有设施的组织单位级别。

_多边形是表示国家，地区或公园的地图上的封闭区域_。

![](resources/images/maps/maps_facility_layer.png)

设施层由层面板中的层 _cards_ 表示，例如
作为：

在设施卡的顶部，从左到右分别是：

-   抓取字段，允许使用鼠标拖动和重新排序图层

-   **设施**标题

-   用于切换图层可见性的眼睛符号

-   折叠和扩展设施卡的箭头符号

在设施卡的中间是一个指示组的图例
设置表示。

设施卡的底部从左到右分别是：

-   编辑（铅笔）按钮以打开图层配置对话框

-   用于修改图层透明度的滑块

-   具有更多选项的更多操作（三个点）按钮：

    -   **数据表**切换按钮可显示或隐藏与图层关联的数据表

    -   **下载数据**允许您以GeoJSON格式下载此图层的数据，以供其他地图软件使用

    -   **编辑图层**与上方的编辑按钮相同

    -   **移除图层**将从当前地图中移除该图层。

### 创建设施层 { #create-a-facility-layer }

要创建设施层，请在“添加层**选择上选择**设施**。这将打开“设施层**配置对话框。

1.  在**组集**标签中：

    ![](resources/images/maps/maps_facility_layer_dialog_GROUPSET.png)

    -   从为您的DHIS2实例定义的组织单位组集的列表中选择一个**组集**。

2.  在**组织单位**标签中

    ![](resources/images/maps/maps_facility_layer_dialog_ORG_UNITS.png)

    -   从右侧的选择栏中选择组织单位级别和/或组别。

    -   选择要包含在图层中的组织单位。可以选择

        -   一个或多个特定的组织单位，或

        -   组织单位层次结构中相对于用户的相对级别。通过选择**用户组织单位**，对于组织单位层次结构中不同级别的用户，地图数据将以不同的方式显示。

3.  在**样式**标签中：

    ![](resources/images/maps/maps_facility_layer_dialog_STYLE.png)

    -   选择您想要应用于设施的任何样式。

        -   显示标签

            允许在图层上显示标签。字体大小、重量和颜色均可在此修改。

        -   显示缓冲区

            允许在图层上显示每个设施周围的视觉缓冲区。缓冲区的半径可在此处修改。

4.  点击**添加图层**。

### 创建或修改设施层 { #create-or-modify-a-facility-layer }

1.  在图层面板中，单击设施图层卡上的编辑（铅笔）图标。

2.  根据需要修改 "组设置"、"组织单位 "和 "风格 "选项卡上的设置。

3.  点击**更新图层**。

### 过滤设施层中的值 { #filter-values-in-a-facility-layer }

设施层有一个**数据表**选项，可以打开或
离设施层卡。

![](resources/images/maps/maps_facility_layer_data_table.png)

数据表显示构成设施层的数据。

-   点击标题将根据该列对表格进行排序；在升序和降序之间切换。

-   在标题下方的筛选字段中输入文本或表达式，将对数据应用这些筛选，显示内容将根据筛选进行调整。筛选器的应用如下：

    -   名称

        按包含给定文本的名称过滤

    -   身份证

        按包含给定文本的ID进行过滤

    -   类型

        按包含给定文本的GIS显示类型过滤

> **注**
>
> 数据表筛选器是临时的，不会作为收藏夹的一部分与地图图层一起保存。

### 搜索设施 { #search-for-a-facility }

数据表中的 NAME 过滤器字段提供了一种有效的方法
寻找个人设施。

### 删除设施层 { #remove-facility-layer }

要清除设施层中的所有数据：

1.  在左侧的图层卡中，单击_more actions_（三个点）图标，然后在**删除图层**上单击。

    该图层将从当前地图中删除。

### 分层管理设施 { #manage-facilities-in-a-layer }

您可以在**设施**，**边界**和**主题**层中使用设施。

#### 搬迁设施 { #relocate-a-facility }

1.  右键单击设施，然后单击**重新定位**。

2.  将光标放在新位置。

    新坐标将永久存储。这不能被撤消。

#### 交换设施的经度和纬度 { #swap-longitude-and-latitude-of-a-facility }

1.  右键单击设施，然后单击**交换经度/纬度**。

    如果用户在创建组织单位时颠倒了经纬度坐标，这将非常有用。

#### 显示设施信息 { #display-facility-information }

您可以查看管理员设置的组织单位信息为
如下：

 <table>
 <caption>查看组织单位信息</caption>
 <colgroup>
 <col style="width: 40%" />
 <col style="width: 59%" />
 </colgroup>
 <thead>
 <tr class="header">
 <th>功能</th>
 <th>操作</th>
 </tr>
 </thead>
 <tbody>
 <tr class="odd">
 <td> <p>查看当前期间的信息</p> </td>
  <ol type="1"><td>
 <li><p>单击设施。 </p></li>
 </ol> </td>
 </tr>
 <tr class="even">
 <td> <p>查看选定时间段的信息 </p></td>
 <td> <ol type="1">
  <li><p>右键单击设施，然后单击<strong>显示信息</strong></p>
</li>  
<li><p> 在<strong>基础数据</strong>部分中，选择一个周期。 </p></li>
 </ol>
 <blockquote>
 <p><strong>注意</strong></p>
 <p>您可以在<strong>系统设置</strong>应用中配置显示的基础数据。 </p>
 </blockquote> </td>
 </tr>
 </tbody>
 </table>

## 管理边界层 { #using_maps_boundary_layer }

边界层显示您的边界和位置
组织单位。如果您处于离线状态，此层特别有用
并且无法访问背景地图。

![](resources/images/maps/maps_bound_layers.png)

边界层由层面板中的层 _cards_ 表示，例如
作为：

边界卡的顶部从左到右分别是：

-   抓取字段，允许使用鼠标拖动和重新排序图层

-   **边界**标题

-   箭头符号，用于折叠和展开边界卡

边界卡的底部从左到右分别是：

-   编辑（铅笔）按钮以打开图层配置对话框

-   用于切换图层可见性的眼睛符号

-   用于修改图层透明度的滑块

-   具有更多选项的更多操作（三个点）按钮：

    -   **数据表**切换按钮可显示或隐藏与图层关联的数据表

    -   **下载数据**允许您以GeoJSON格式下载此图层的数据，以供其他地图软件使用

    -   **编辑图层**与上方的编辑按钮相同

    -   **移除图层**将从当前地图中移除该图层。

### 创建边界层 { #create-a-boundary-layer }

要创建边界层，请在**添加层**选择上选择**边界**。这将打开边界层配置对话框。

1.  在**组织单位**标签中

    ![](resources/images/maps/maps_boundary_layer_dialog_ORG_UNITS.png)

    -   从右侧的选择栏中选择组织单位级别和/或组别。

    -   选择要包含在图层中的组织单位。可以选择

        -   一个或多个特定的组织单位，或

        -   组织单位层次结构中相对于用户的相对级别。通过选择**用户组织单位**，对于组织单位层次结构中不同级别的用户，地图数据将以不同的方式显示。

2.  在**样式**标签中：

    ![](resources/images/maps/maps_boundary_layer_dialog_STYLE.png)

    -   选择要应用于边界的任何样式。

        -   显示标签

            允许在图层上显示标签。字体大小和重量可在此处修改。

        -   点半径

            设置在边界层上显示点类型元素（如设施）时的基准半径。

3.  点击**添加图层**。

### 修改边界层 { #modify-a-boundary-layer }

1.  在图层面板中，单击边界层卡上的编辑（铅笔）图标。

2.  根据需要修改 "组织单位 "和 "样式 "选项卡上的设置。

3.  点击**更新图层**。

### 过滤边界层中的值 { #filter-values-in-a-boundary-layer }

边界层有一个**数据表**选项，可以从边界层卡上打开或关闭。

![](resources/images/maps/maps_bound_layer_data_table.png)

数据表显示构成边界层的数据。

-   点击标题将根据该列对表格进行排序；在升序和降序之间切换。

-   在标题下方的筛选字段中输入文本或表达式，将对数据应用这些筛选，显示内容将根据筛选进行调整。筛选器的应用如下：

    -   名称

        按包含给定文本的名称过滤

    -   水平

        按数字和/或范围过滤级别，例如：2，\> 3＆\ <8

    -   父母

        按包含给定文本的父项名称过滤

    -   身份证

        按包含给定文本的ID进行过滤

    -   类型

        按包含给定文本的GIS显示类型过滤

> **注**
>
> 数据表筛选器是临时的，不会作为收藏夹的一部分与地图图层一起保存。

### 搜索组织单位 { #search-for-an-organisational-unit }

数据表中的 NAME 过滤器字段提供了一种有效的方法
搜索边界中显示的单个组织单位
层。

### 在组织层次结构之间导航 { #navigate-between-organisation-hierarchies }

您可以在层次结构中修改边界层的目标，而无需
使用级别/父用户界面。

1.  用鼠标右键单击边界之一。

2.  选择**向上钻取一级**或**向下钻取一级**。

    如果您在最底层，向下钻取选项将被禁用。同样，从最高层向上钻取选项也被禁用。

### 移除边界层 { #remove-boundary-layer }

要清除边界层中的所有数据：

1.  在左侧的图层卡中，单击_more actions_（三个点）图标，然后在**删除图层**上单击。

    该图层将从当前地图中删除。

## 管理地球引擎层 { #using_maps_gee }

![](resources/images/maps/maps_earth_eng_layer.png)

Google Earth Engine 中的图层可让您显示和聚合外部
数据到您的组织单位。使用人口图层来计算
居住在一个地区或距离卫生保健机构不远的人数
设施。高程图层允许您找到最低、最高和
平均海拔。使用土地覆盖层查看森林覆盖、农田
或城市地区，并计算每个组织单位的百分比。

支持以下层：

![](resources/images/maps/maps_earth_eng_layer_types.png)

-   **人口**：WorldPop 提供的详细人口数据，显示生活在某一地区的估计人口数量。可提供 2000 年及以后的年度数据。

-   **人口年龄组**：一个地区按年龄和性别分组的估计人口数量。

-   **海拔**：海拔高度。

-   **降水量**：数值以 5 天内的毫米为单位。每月更新一次，更新时间为下一个月的第 3 周。从卫星和地面气象站收集。

-   **温度**：卫星采集的陆地表面温度。有持续云层覆盖的地区会出现空白点。

-   **土地覆盖**：美国宇航局从卫星收集的 17 种不同的土地覆盖类型。

### 创建地球引擎图层 { #create-an-earth-engine-layer }

要创建 Earth Engine 图层，请从 **Add
层**选择。这将打开层配置对话框。

1.  在**数据**标签中：

    ![](resources/images/maps/maps_ee_layer_dialog_DATA.png)

    -   For "population age groups" you can select the age/gender **groups** you would like to include when aggregating the data.

    -   在计算所选组织单位的数值时，选择您希望使用的**汇总方法**。

        -   **总和**：计算每个组织单位内的总人数。建议用于人口层。

        -   **Min**：返回所选内容下方显示的图层单位中的最小值。对于人口层，它将是每公顷的最低_人数_。对于高程图层，它将返回最低海拔（海拔米）。

        -   **Max**：以层为单位返回最大值。对于人口层，它将是_每公顷的最低人数_。对于高程图层，它将返回每个组织单位的最高海拔。

        -   **Mean**：返回层单位的平均值。对于人口层，它将是平均_每公顷人数_。对于降水层，它将是整个组织单位的平均降雨量，以毫米为单位。

        -   **Median**：以层为单位返回平均值。对于人口层，它将是每公顷的中位数_人_。对于温度层，它将是组织单元白天的中值°C。

        -   **标准偏差**：返回以层为单位的标准偏差值。

        -   **Variance**：以层为单位返回方差值。

2.  在**期间**标签中

    ![](resources/images/maps/maps_ee_layer_dialog_PERIOD.png)

    -   选择数据源的周期。可用周期由数据提供者设定。人口年龄组 "图层只有一个时段，而 "人口 "图层则有 2000 年及以后的年度数据。降水数据以 5 天为一个时段，温度数据以 8 天为一个时段。

3.  在**ORG UNITS**标签中：

    ![](resources/images/maps/maps_ee_layer_dialog_ORG_UNITS.png)

    -   选择要查看汇总数据值的组织单位。可以选择

        -   一个或多个特定的组织单位、组织单位层次结构中的层级、组织单位组，或

        -   组织单位层次结构中相对于用户的相对级别。通过选择**用户组织单位**，对于组织单位层次结构中不同级别的用户，地图数据将以不同的方式显示。

4.  在**样式**标签中

    ![](resources/images/maps/maps_ee_layer_dialog_STYLE.png)

    -   修改特定于图层类型的参数。

    -   根据需要调整图例范围，步长和颜色。

    -   如果您选择的组织单位只有一个点坐标（设施），您可以设置一个半径缓冲区来计算数据值。如果半径为 5000 米，则会汇总设施 5 公里范围内的所有可用值。

5.  点击**添加图层**。

单击地图区域或设施以查看其聚合结果
组织单位。

### 数据值列表 { #listing-of-data-values }

地球引擎层有一个**数据表**选项，可以打开或
离层卡。

![](resources/images/maps/maps_ee_layer_data_table.png)

数据表显示所选组织单位的所有聚合值。

-   点击标题将根据该列对表格进行排序；在升序和降序之间切换。

-   在标题下方的筛选字段中输入文本或表达式，将对数据应用这些筛选，显示内容将根据筛选进行调整。筛选器的应用如下：

-   名称

    按包含给定文本的组织单位名称过滤

-   身份证

    按包含给定文本的事件ID进行过滤

-   类型

    按包含给定文本的GIS显示类型过滤

-   聚合值

    每个选择的聚合类型都有一列

    数值数据值可以通过给定的数字和/或范围进行筛选，例如：2,\>3&\<8

> **注意**
>
> 数据表过滤器是临时的，不会与地图图层一起保存。

## 添加外部地图图层 { #using_maps_external_map_layers }

![](resources/images/maps/maps_terrain_imagery.png)

外部地图图层表示为：

-   底图

    这些可在图层面板的**底图**卡中找到，并被选择为其他任何底图。

-   叠加层

    这些在**添加图层**选择中可用。与底图不同，可以将叠加层放置在任何其他叠加层的上方或下方。

叠加层由层中的附加层_cards_表示
面板如：

覆盖卡的顶部从左到右分别是：

-   抓取字段，允许使用鼠标拖动和重新排序图层

-   外部地图图层的标题

-   折叠和展开覆盖卡的箭头符号

如果图层有图例，则卡的中间是图例。

覆盖卡的底部从左到右分别是：

-   用于修改图层透明度的滑块

-   删除（垃圾桶）图标，用于从当前专题地图中删除图层。

## 文件菜单 { #using_maps_file_menu }

![](resources/images/maps/maps_file_menu.png)

使用**文件”菜单**来管理您的地图。在打开或保存地图之前，将禁用几个菜单项。

保存您的地图可以轻松地在以后恢复它们。它还给你
有机会与其他用户分享它们作为解释或
把它放在仪表板上。您可以保存所有类型的图层配置
作为最爱。

### 建立新地图 { #create-a-new-map }

点击**文件** \> **新建**。

注意！这将清除您当前拥有的地图图层，而不进行保存。

### 开启新地图 { #open-a-new-map }

1.  点击**文件** \> **打开**。将打开一个对话框，其中包含地图列表。

2.  查找您要打开的收藏夹。您可以使用\ < and \>或搜索字段来查找已保存的地图。该列表将根据您输入的每个字符进行过滤。您可以通过选择**显示全部**，**由我创建**或**由其他人创建**来过滤列表。

3.  点击要打开的地图的名称。

### 保存地图 { #save-a-map }

创建地图后，可以方便地将其保存以备后用：

1.  单击**文件** \> **保存**。

2.  首次保存地图时，请输入**名称**（必填）和**描述**（可选）。

3.  点击**保存**。

### 保存地图副本 { #save-a-copy-of-a-map }

1.  单击**文件** \> **另存为... **

2.  输入地图的**名称**（必填）和**描述**（可选）。

3.  点击**保存**。

### 重命名地图 { #rename-a-map }

1.  点击**文件** \> **重命名**。

2.  为您的地图输入新的**名称**和/或**描述**。

3.  点击**重命名**。地图已更新。

### 翻译地图 { #translate-a-map }

1.  点击**文件** \>**翻译**。

2.  选择您的翻译的**地方语言**（语言）。

3.  输入翻译后的**名称**和**说明**。原始文本将显示在该字段下方。

4.  点击**保存**。

### 修改地图的共享设置 { #modify-sharing-settings-for-a-map }

创建并保存地图后，您可以与以下人员共享地图
每个人或一个用户组。要修改共享设置：

1.  点击**文件** \>**共享**。共享设置对话框打开。

2.  在文本框中，搜索要与之共享收藏夹的用户或组名称，然后选择它。

    所选的用户或组将添加到收件人列表中。

    重复该步骤以添加更多用户组。

3.  如果要允许外部访问，请选择相应的框。

4.  对于每个用户组，选择一个访问设置。选项包括：

    -   无（仅适用于默认组，因为它们无法删除）

    -   可以查看

    -   可以编辑和查看

5.  单击**关闭**以关闭对话框。

### 获取地图链接 { #get-the-link-to-a-map }

1.  点击**文件** \> **获取链接**。将打开一个链接对话框。

2.  复制链接。

### 删除地图 { #delete-a-map }

1.  点击**文件** \>**删除**。显示确认对话框。

2.  单击**删除**确认要删除收藏夹。您的地图将被删除，图层也将从视图中清除。

## 地图解译 { #mapsInterpretation }

解释是对给定时间段内地图的描述。此信息在“仪表板应用程序”中可见。单击工作区右上方的**解释”**以打开**解释**面板。仅在保存了地图的情况下，该按钮才可单击。

![](resources/images/maps/maps_interpretations_panel.png)

### 查看基于相对期间的解释 { #view-interpretations-based-on-relative-periods }

要查看相对时期的解释，例如一年前：

1.  用解释打开收藏夹。

2.  单击工作区右上方的**解释**以打开解释面板。

3.  点击释义。地图上会显示数据和基于解释创建时间的日期。要查看其他解释，请单击它们。

### 为地图写解释 { #write-interpretation-for-a-map }

要创建解释，您首先需要创建地图并保存。
如果您与其他人分享了您的地图，您的解释
write 对那些人是可见的。

1.  用解释打开收藏夹。

2.  单击工作区右上方的**解释**以打开解释面板。

3.  对于拥有收藏夹读取权限的用户，将出现一个文本字段，其中的占位符为 "撰写释义"。

4.  在文本字段中，输入评论，问题或解释。您也可以使用' @username'提及其他用户。首先输入' @'，再加上用户名或真实姓名的首字母，然后出现一个提述栏，以显示可用的用户。提及的用户将收到内部DHIS2消息以及解释或评论。您可以在**仪表板应用程序**中查看解释。

5.  如果您希望您的解释与地图具有相同的共享设置，请单击**保存**。

    如果要更改共享设置（请参阅下文）以进行解释，请单击**保存并共享**。

### 更改解释的共享设置 { #change-sharing-settings-for-an-interpretation }

1.  单击一个解释（请参阅上面的查看解释）。

2.  单击解释下方的**共享**。共享设置对话框打开。

3.  搜索并添加要共享地图的用户和用户组。

4.  更改要修改的用户的共享设置：

    -   **可以编辑和查看**：每个人都可以查看和编辑对象。

    -   **只能查看**：每个人都可以查看对象。

    -   **无访问权限**：公众无法访问对象。此设置仅适用于公众访问。

5.  共享设置更新后，单击**关闭**。

## 将地图另存为图像 { #using_maps_image_export }

您可以通过单击顶部菜单中的“下载”按钮将地图下载为图像

![](resources/images/maps/maps_download.png)

Internet Explorer 或 Safari 不支持地图下载，我们建议您
使用谷歌浏览器或火狐浏览器。

1.  选择是否包含地图名称。此选项只有在保存地图时可用。

2.  选择是否要包含地图图例。您可以将图例放置在地图的四个角之一。

3.  点击**下载**以下载地图。

## 搜索位置 { #using_maps_search }

地点搜索功能可让您搜索几乎任何位置
或地址。此功能可用于定位例如
地图上的地点、设施、村庄或城镇。

![](resources/images/maps/maps_place_search.png)

1.  在“地图”窗口的右侧，单击放大镜图标。

2.  输入您要查找的位置。

    键入时会显示匹配位置的列表。

3.  从列表中选择一个地点。地图上的图钉会指示该位置。

## 测量地图中的距离和面积 { #using_maps_measure_distance }

1.  在地图左上方，将光标放在**测量距离和面积**（标尺）图标上，然后点击**创建新测量**。

2.  在地图上添加点。

3.  点击**完成测量**。

![](resources/images/maps/maps_measure_distance.png)

## 获取任意位置的纬度和经度 { #using_maps_latitude_longitude }

右键点击地图上的一个点，然后选择**显示经度/纬度**。值显示在弹出窗口中。

## 也可以看看 { #see-also }

-   [管理传说](https://docs.dhis2.org/master/en/user/html/manage_legend.html)
